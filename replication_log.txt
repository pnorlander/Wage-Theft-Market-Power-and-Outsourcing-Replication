-------------------------------------------------------------------------------
      name:  <unnamed>
       log:  /Users/peternorlander/replication/for_upload/replication_log.txt
  log type:  text
 opened on:  14 Feb 2026, 21:30:06

. 
. di "=========================================================================
> ======"
===============================================================================

. di "REPLICATION PACKAGE"
REPLICATION PACKAGE

. di "Paper: Wage Theft, Market Power, and Outsourcing: The Case of H-1B Worker
> s"
Paper: Wage Theft, Market Power, and Outsourcing: The Case of H-1B Workers

. di "Started: $S_DATE $S_TIME"
Started: 14 Feb 2026 21:30:06

. di "=========================================================================
> ======"
===============================================================================

. di ""


. 
. if `run_regressions' == 1 {
.     di "MODE: Full replication (running all regressions)"
.     di "WARNING: This may take several hours"
. }

. else {
.     di "MODE: Using pre-computed .ster files (fast)"
MODE: Using pre-computed .ster files (fast)
.     di "To run regressions from scratch, set run_regressions = 1 in 00_master
> .do"
To run regressions from scratch, set run_regressions = 1 in 00_master.do
. }

. di ""


. 
. *----------------------------------------------------------------------------
> ---
. * STEP 1: RUN REGRESSIONS (OPTIONAL - skip if using pre-computed .ster files)
. *----------------------------------------------------------------------------
> ---
. if `run_regressions' == 1 {
.     di "=============================================="
.     di "STEP 1: Running all regressions..."
.     di "=============================================="
.     di ""
.     do "$code/01a_run_regressions.do"
. }

. else {
.     di "=============================================="
==============================================
.     di "STEP 1: Skipping regressions (using pre-computed .ster files)"
STEP 1: Skipping regressions (using pre-computed .ster files)
.     di "=============================================="
==============================================
.     di ""

. }

. 
. *----------------------------------------------------------------------------
> ---
. * STEP 2: GENERATE TABLES (from .ster files)
. *----------------------------------------------------------------------------
> ---
. di "=============================================="
==============================================

. di "STEP 2: Generating tables..."
STEP 2: Generating tables...

. di "=============================================="
==============================================

. di ""


. do "$code/01_tables.do"

. *============================================================================
> ===
. * 01_tables.do
. * Generates Tables 1, 2, 3, 5, A.1-A.12
. *
. * Data files required:
. *   - data/master_db.dta (for Tables 1, 2, 5)
. *   - sters/.ster files (for Tables 3, A.1-A.12)
. *
. * PAPER TABLE MAPPING:
. *   Paper Table 1 = Descriptive Statistics
. *   Paper Table 2 = Wages, Skill Levels, Subcontractor Status (6 columns)
. *   Paper Table 3 = Log Violations (7 columns)
. *   Paper Table 5 = Marginal Effects (Panels A & B)
. *   Paper Table A.1 = Negative Binomial Regression
. *   Paper Table A.2 = Weighted Log Violations (Panel A: FE, Panel B: RE)
. *   Paper Table A.3 = Weighted Log Back Wages (Panel A: FE, Panel B: RE)
. *   Paper Table A.4 = Unweighted Log Back Wages (7 columns)
. *   Paper Table A.5 = Log Back Wages per Promised Wages (Panel A: FE, Panel B
> : RE)
. *   Paper Table A.6 = Log Back Wages/Promised Wages with HHI×Subcontractor (8
>  columns)
. *   Paper Table A.7 = Log Violations at Industry-CZ-Year level (8 columns)
. *   Paper Table A.8 = Log Violations at Occ-CZ-Year level (8 columns)
. *   Paper Table A.9 = Unweighted Log Violations (Panel A: FE, Panel B: RE)
. *   Paper Table A.10 = Log Violations with HHI×Subcontractor (8 columns)
. *   Paper Table A.11 = Unweighted Log Back Wages (Panel A: FE, Panel B: RE)
. *   Paper Table A.12 = Log Back Wages with HHI×Subcontractor (8 columns)
. *
. * STER File Naming Convention:
. *   - table2_col1.ster through table2_col6.ster (Wages, Skill Levels - Paper 
> Table 2)
. *   - table3_col1.ster through table3_col7.ster (Log Violations - Paper Table
>  3)
. *   - tablea1_col1.ster through tablea1_col7.ster (Negative Binomial)
. *   - tablea2a_col1.ster through tablea2a_col4.ster (Weighted Log Violations 
> - FE)
. *   - tablea2b_col1.ster through tablea2b_col4.ster (Weighted Log Violations 
> - RE)
. *   - tablea3a_col1.ster through tablea3a_col4.ster (Weighted Log Back Wages 
> - FE)
. *   - tablea3b_col1.ster through tablea3b_col4.ster (Weighted Log Back Wages 
> - RE)
. *   - tablea4_col1.ster through tablea4_col7.ster (Unweighted Log Back Wages)
. *   - tablea5a_col1.ster through tablea5a_col4.ster (Log Back Wages/Promised 
> Wages - FE)
. *   - tablea5b_col1.ster through tablea5b_col4.ster (Log Back Wages/Promised 
> Wages - RE)
. *   - tablea6_col1.ster through tablea6_col8.ster (Log Back Wages/Promised Wa
> ges with HHI×Sub)
. *   - tablea7_col1.ster through tablea7_col8.ster (Log Violations at Industry
> -CZ-Year level)
. *   - tablea8_col1.ster through tablea8_col8.ster (Log Violations at Occ-CZ-Y
> ear level)
. *   - tablea9a_col1.ster through tablea9a_col4.ster (Unweighted Log Violation
> s - FE)
. *   - tablea9b_col1.ster through tablea9b_col4.ster (Unweighted Log Violation
> s - RE)
. *   - tablea10_col1.ster through tablea10_col8.ster (Log Violations with HHI×
> Sub)
. *   - tablea11a_col1.ster through tablea11a_col4.ster (Unweighted Log Back Wa
> ges - FE)
. *   - tablea11b_col1.ster through tablea11b_col4.ster (Unweighted Log Back Wa
> ges - RE)
. *   - tablea12_col1.ster through tablea12_col8.ster (Log Back Wages with HHI×
> Sub)
. *
. * Tables generated:
. *   - Table 1: Descriptive Statistics
. *   - Table 2: Wages, Skill Levels, and Subcontractor Status
. *   - Table 3: Effect of Labor Market Power on Log(Violations)
. *   - Table 5: Marginal Effects - Changes in Probability (PRE-GENERATED)
. *   - Table A.1: Negative Binomial Regression Results
. *   - Table A.2 Panel A: Weighted Regressions - Firm FE - Log(Violations)
. *   - Table A.2 Panel B: Weighted Regressions - Random Effects - Log(Violatio
> ns)
. *   - Table A.3 Panel A: Weighted Regressions - Firm FE - Log(Back Wages)
. *   - Table A.3 Panel B: Weighted Regressions - Random Effects - Log(Back Wag
> es)
. *   - Table A.4: Unweighted Regressions - Log(Back Wages)
. *   - Table A.5 Panel A: Firm FE - Log(Back Wages/Promised Wages)
. *   - Table A.5 Panel B: Random Effects - Log(Back Wages/Promised Wages)
. *   - Table A.6: Cell-level OLS with HHI×Subcontractor - Log(Back Wages/Promi
> sed Wages)
. *   - Table A.7: Cell-level OLS Log(Violations) at Industry-CZ-Year level
. *   - Table A.8: Cell-level OLS Log(Violations) at Occ-CZ-Year level
. *   - Table A.9 Panel A: Unweighted Firm FE - Log(Violations)
. *   - Table A.9 Panel B: Unweighted Random Effects - Log(Violations)
. *   - Table A.10: Cell-level OLS with HHI×Subcontractor - Log(Violations)
. *   - Table A.11 Panel A: Unweighted Firm FE - Log(Back Wages)
. *   - Table A.11 Panel B: Unweighted Random Effects - Log(Back Wages)
. *   - Table A.12: Cell-level OLS with HHI×Subcontractor - Log(Back Wages)
. *============================================================================
> ===
. 
. *----------------------------------------------------------------------------
> ---
. * TABLE 1: DESCRIPTIVE STATISTICS
. * Source: dos/descriptives.do lines 36-67
. *
. * Paper Table 1 has TWO panels:
. *   - Panel A: Full Sample (N = 1,353,017)
. *   - Panel B: Firms with Violations / FE Sample (N = 25,683)
. *
. * Variables (NO Unemployment Rate - not in published paper):
. *   - Violations
. *   - % of Cells with any Violations
. *   - Back Wages
. *   - Number of H-1Bs
. *   - HHI
. *   - Subcontractor
. *----------------------------------------------------------------------------
> ---
. 
. di "===== TABLE 1: DESCRIPTIVE STATISTICS ====="
===== TABLE 1: DESCRIPTIVE STATISTICS =====

. 
. use "$data/master_db.dta", clear

. keep if category_set==3
(113,347 observations deleted)

. 
. *--- PANEL A: Full Sample ---
. di "Panel A: Full Sample"
Panel A: Full Sample

. estpost su viol logviol anyviol bw nbr_h1bs hhithreeyearavg subcontractor

             |  e(count)   e(sum_w)    e(mean)     e(Var)      e(sd) 
-------------+-------------------------------------------------------
        viol |   1353017    1353017   .0437285    4.48487   2.117751 
     logviol |   1238730    1238730   .0227412   .1375113   .3708251 
     anyviol |   1353017    1353017   .0041744    .004157   .0644744 
          bw |   1353017    1353017   172.9451   9.16e+07   9570.912 
    nbr_h1bs |   1353017    1353017   3.509118   83.23823   9.123499 
hhithreeye~g |   1351786    1351786   .1421009   .0361611   .1901607 
subcontrac~r |   1353017    1353017   .0705047   .0655338   .2559957 

             |    e(min)     e(max)     e(sum) 
-------------+---------------------------------
        viol |         0   484.6979   59165.44 
     logviol |         0    12.7883   28170.16 
     anyviol |         0          1       5648 
          bw |         0    2159247   2.34e+08 
    nbr_h1bs |         0         70    4747896 
hhithreeye~g |  .0014996          1     192090 
subcontrac~r |         0          1      95394 

. est sto panelA

. di "Full sample N = `e(N)'"
Full sample N = 1353017

. 
. *--- PANEL B: Fixed Effects Sample (firms with violations) ---
. di "Panel B: FE Sample"
Panel B: FE Sample

. 
. * Generate sample indicator for fixed effects estimation
. * (matches the sample used in firm FE regressions)
. egen company = group(name)
(11 missing values generated)

. replace viol=round(viol)
(5,648 real changes made)

. xtset company

Panel variable: company (unbalanced)

. qui xtnbreg viol hhithreeyearavg, fe

. gen sample=(e(sample)==1)

. 
. estpost su viol logviol anyviol bw nbr_h1bs hhithreeyearavg subcontractor if 
> sample==1

             |  e(count)   e(sum_w)    e(mean)     e(Var)      e(sd) 
-------------+-------------------------------------------------------
        viol |     25673      25673   2.293927   231.0374   15.19991 
     logviol |     23850      23850   1.104013   5.591509   2.364637 
     anyviol |     25673      25673   .2006388   .1603891   .4004861 
          bw |     25673      25673   8693.395   4.72e+09   68696.01 
    nbr_h1bs |     25673      25673   16.37185   536.7778   23.16847 
hhithreeye~g |     25673      25673   .1490164   .0291077   .1706099 
subcontrac~r |     25673      25673   .5968917   .2406214   .4905317 

             |    e(min)     e(max)     e(sum) 
-------------+---------------------------------
        viol |         0        485      58892 
     logviol |         0    12.7883    26330.7 
     anyviol |         0          1       5151 
          bw |         0    2159247   2.23e+08 
    nbr_h1bs |         0         70   420314.4 
hhithreeye~g |  .0014996          1   3825.698 
subcontrac~r |         0          1      15324 

. est sto panelB

. di "FE sample N = `e(N)'"
FE sample N = 25673

. 
. *--- Output Panel A ---
. esttab panelA using $tables/table1_panelA.tex, ///
>   cells("mean(fmt(3)) sd(fmt(3)) min(fmt(3)) max(fmt(3)) p50(fmt(3))") ///
>   title(Panel A: Full Sample) ///
>   substitute(mean Mean sd SD min Min max Max p50 Median) label replace
(output written to ./output/tables/table1_panelA.tex)

. 
. *--- Output Panel B ---
. esttab panelB using $tables/table1_panelB.tex, ///
>   cells("mean(fmt(3)) sd(fmt(3)) min(fmt(3)) max(fmt(3)) p50(fmt(3))") ///
>   title(Panel B: Fixed Effects Sample) ///
>   substitute(mean Mean sd SD min Min max Max p50 Median) label replace
(output written to ./output/tables/table1_panelB.tex)

. 
. *--- Combined Table 1 (both panels) ---
. * Create a combined LaTeX file with both panels
. file open table1 using "$tables/table1.tex", write replace

. file write table1 "\begin{table}[htbp]\centering" _n

. file write table1 "\caption{Descriptive Statistics}" _n

. file write table1 _n

. file write table1 "% Panel A: Full Sample" _n

. file write table1 "\textbf{Panel A: Full Sample}" _n

. file write table1 "\vspace{0.5em}" _n

. file write table1 _n

. file write table1 "\def\sym#1{\ifmmode^{#1}\else\(^{#1}\)\fi}" _n

. file write table1 "\begin{tabular}{l*{1}{ccccc}}" _n

. file write table1 "\hline\hline" _n

. file write table1 "                    &        Mean&          SD&         Mi
> n&         Max&      Median\\" _n

. file write table1 "\hline" _n

. 
. * Get Panel A statistics (using detail option to get median via r(p50))
. qui su viol, detail

. file write table1 "Violations          &" %12.3f (`r(mean)') "&" %12.3f (`r(s
> d)') "&" %12.3f (`r(min)') "&" %12.3f (`r(max)') "&" %12.3f (`r(p50)') "\\" _
> n

. qui su logviol, detail

. file write table1 "Violations Intensity          &" %12.3f (`r(mean)') "&" %1
> 2.3f (`r(sd)') "&" %12.3f (`r(min)') "&" %12.3f (`r(max)') "&" %12.3f (`r(p50
> )') "\\" _n

. qui su anyviol, detail

. file write table1 "\% of Cells with any Violations&" %12.3f (`r(mean)') "&" %
> 12.3f (`r(sd)') "&" %12.3f (`r(min)') "&" %12.3f (`r(max)') "&" %12.3f (`r(p5
> 0)') "\\" _n

. qui su bw, detail

. file write table1 "Back Wages          &" %12.3f (`r(mean)') "&" %12.3f (`r(s
> d)') "&" %12.3f (`r(min)') "&" %12.3f (`r(max)') "&" %12.3f (`r(p50)') "\\" _
> n

. qui su nbr_h1bs, detail

. file write table1 "Number of H-1Bs     &" %12.3f (`r(mean)') "&" %12.3f (`r(s
> d)') "&" %12.3f (`r(min)') "&" %12.3f (`r(max)') "&" %12.3f (`r(p50)') "\\" _
> n

. qui su hhithreeyearavg, detail

. file write table1 "HHI                 &" %12.3f (`r(mean)') "&" %12.3f (`r(s
> d)') "&" %12.3f (`r(min)') "&" %12.3f (`r(max)') "&" %12.3f (`r(p50)') "\\" _
> n

. qui su subcontractor, detail

. file write table1 "Subcontractor       &" %12.3f (`r(mean)') "&" %12.3f (`r(s
> d)') "&" %12.3f (`r(min)') "&" %12.3f (`r(max)') "&" %12.3f (`r(p50)') "\\" _
> n

. 
. qui count

. local panelA_N = r(N)

. file write table1 "\hline" _n

. file write table1 "Observations        &" %12.0fc (`panelA_N') "&            
> &            &            &            \\" _n

. file write table1 "\hline" _n

. file write table1 "\end{tabular}" _n

. file write table1 _n

. file write table1 "\vspace{1em}" _n

. file write table1 _n

. file write table1 "% Panel B: Fixed Effects Sample" _n

. file write table1 "\textbf{Panel B: Fixed Effects Sample (Firms with Violatio
> ns)}" _n

. file write table1 "\vspace{0.5em}" _n

. file write table1 _n

. file write table1 "\begin{tabular}{l*{1}{ccccc}}" _n

. file write table1 "\hline\hline" _n

. file write table1 "                    &        Mean&          SD&         Mi
> n&         Max&      Median\\" _n

. file write table1 "\hline" _n

. 
. * Get Panel B statistics (using detail option to get median via r(p50))
. qui su viol if sample==1, detail

. file write table1 "Violations          &" %12.3f (`r(mean)') "&" %12.3f (`r(s
> d)') "&" %12.3f (`r(min)') "&" %12.3f (`r(max)') "&" %12.3f (`r(p50)') "\\" _
> n

. qui su logviol if sample==1, detail

. file write table1 "Violations Intensity         &" %12.3f (`r(mean)') "&" %12
> .3f (`r(sd)') "&" %12.3f (`r(min)') "&" %12.3f (`r(max)') "&" %12.3f (`r(p50)
> ') "\\" _n

. qui su anyviol if sample==1, detail

. file write table1 "\% of Cells with any Violations&" %12.3f (`r(mean)') "&" %
> 12.3f (`r(sd)') "&" %12.3f (`r(min)') "&" %12.3f (`r(max)') "&" %12.3f (`r(p5
> 0)') "\\" _n

. qui su bw if sample==1, detail

. file write table1 "Back Wages          &" %12.3f (`r(mean)') "&" %12.3f (`r(s
> d)') "&" %12.3f (`r(min)') "&" %12.3f (`r(max)') "&" %12.3f (`r(p50)') "\\" _
> n

. qui su nbr_h1bs if sample==1, detail

. file write table1 "Number of H-1Bs     &" %12.3f (`r(mean)') "&" %12.3f (`r(s
> d)') "&" %12.3f (`r(min)') "&" %12.3f (`r(max)') "&" %12.3f (`r(p50)') "\\" _
> n

. qui su hhithreeyearavg if sample==1, detail

. file write table1 "HHI                 &" %12.3f (`r(mean)') "&" %12.3f (`r(s
> d)') "&" %12.3f (`r(min)') "&" %12.3f (`r(max)') "&" %12.3f (`r(p50)') "\\" _
> n

. qui su subcontractor if sample==1, detail

. file write table1 "Subcontractor       &" %12.3f (`r(mean)') "&" %12.3f (`r(s
> d)') "&" %12.3f (`r(min)') "&" %12.3f (`r(max)') "&" %12.3f (`r(p50)') "\\" _
> n

. 
. qui count if sample==1

. local panelB_N = r(N)

. file write table1 "\hline" _n

. file write table1 "Observations        &" %12.0fc (`panelB_N') "&            
> &            &            &            \\" _n

. file write table1 "\hline\hline" _n

. file write table1 "\end{tabular}" _n

. file write table1 _n

. file write table1 "\end{table}" _n

. file close table1

. 
. di "Table 1 saved to: $tables/table1.tex"
Table 1 saved to: ./output/tables/table1.tex

. di "  Panel A (Full Sample): N = `panelA_N'"
  Panel A (Full Sample): N = 1353017

. di "  Panel B (FE Sample): N = `panelB_N'"
  Panel B (FE Sample): N = 25673

. di ""


. 
. *----------------------------------------------------------------------------
> ---
. * TABLE 2: WAGES, SKILL LEVELS, AND SUBCONTRACTOR STATUS
. * Source: 2019_find_pay_rates.do lines 219-288
. *
. * DV: Wage (in dollars)
. * IVs: HHI category (Moderate/High vs Low), Skill level (2-4 vs 1), Log(H-1Bs
> ), Subcontractor
. * Fixed Effects vary by column:
. *   Col 1: No FE, no clustering
. *   Col 2: Year FE, cluster by CZ
. *   Col 3: Occupation FE, cluster by CZ
. *   Col 4: Commuting Zone FE, cluster by CZ
. *   Col 5: Year + CZ FE, cluster by CZ
. *   Col 6: Year + Occupation FE, cluster by CZ
. *
. * EXPECTED COEFFICIENTS (Moderate HHI row):
. *   Col 1: -191.6, Col 2: -721.9, Col 3: -1466.4, Col 4: 755.6, Col 5: -3.464
> , Col 6: -1344.6
. *
. * REQUIRED EXTERNAL DATA:
. *   - h1b_hhi/2019_cz90_name_occ2.dta (wage level data from H-1B LCA filings)
. *   This file must be merged with master_db.dta to provide wage_level variabl
> e
. *   Run prepare_replication_data.do first to create the merged dataset
. *----------------------------------------------------------------------------
> ---
. 
. di "===== TABLE 2: WAGES, SKILL LEVELS, SUBCONTRACTOR STATUS ====="
===== TABLE 2: WAGES, SKILL LEVELS, SUBCONTRACTOR STATUS =====

. di ""


. di "Loading from .ster files (using subcontractor_2019 variable)..."
Loading from .ster files (using subcontractor_2019 variable)...

. di ""


. 
. estimates clear

. 
. * Load from pre-computed .ster files
. di "Loading Table 2 from sters/"
Loading Table 2 from sters/

. 
. est use "$sters/table2_col1.ster"

. est sto t2_1

. estadd local Year "N"

added macro:
               e(Year) : "N"

. estadd local Occ "N"

added macro:
                e(Occ) : "N"

. estadd local CommuteZone "N"

added macro:
        e(CommuteZone) : "N"

. 
. est use "$sters/table2_col2.ster"

. est sto t2_2

. estadd local Year "Y"

added macro:
               e(Year) : "Y"

. estadd local Occ "N"

added macro:
                e(Occ) : "N"

. estadd local CommuteZone "N"

added macro:
        e(CommuteZone) : "N"

. 
. est use "$sters/table2_col3.ster"

. est sto t2_3

. estadd local Year "N"

added macro:
               e(Year) : "N"

. estadd local Occ "Y"

added macro:
                e(Occ) : "Y"

. estadd local CommuteZone "N"

added macro:
        e(CommuteZone) : "N"

. 
. est use "$sters/table2_col4.ster"

. est sto t2_4

. estadd local Year "N"

added macro:
               e(Year) : "N"

. estadd local Occ "N"

added macro:
                e(Occ) : "N"

. estadd local CommuteZone "Y"

added macro:
        e(CommuteZone) : "Y"

. 
. est use "$sters/table2_col5.ster"

. est sto t2_5

. estadd local Year "Y"

added macro:
               e(Year) : "Y"

. estadd local Occ "N"

added macro:
                e(Occ) : "N"

. estadd local CommuteZone "Y"

added macro:
        e(CommuteZone) : "Y"

. 
. est use "$sters/table2_col6.ster"

. est sto t2_6

. estadd local Year "Y"

added macro:
               e(Year) : "Y"

. estadd local Occ "Y"

added macro:
                e(Occ) : "Y"

. estadd local CommuteZone "N"

added macro:
        e(CommuteZone) : "N"

. 
. * Output Table 2 - handle both subcontractor and subcontractor_2019 variable 
> names
. * The coefficient will appear as either 1.subcontractor or 1.subcontractor_20
> 19 depending on source
. esttab t2_1 t2_2 t2_3 t2_4 t2_5 t2_6 using "$tables/table2.tex", ///
>     keep(2.hhicat 3.hhicat 2.round_wage_level 3.round_wage_level 4.round_wage
> _level logimm 1.subcontractor 1.subcontractor_2019) ///
>     order(2.hhicat 3.hhicat 2.round_wage_level 3.round_wage_level 4.round_wag
> e_level logimm 1.subcontractor 1.subcontractor_2019) ///
>     coeflabels(2.hhicat "Moderate HHI" 3.hhicat "High HHI" ///
>                2.round_wage_level "Skill Level 2" 3.round_wage_level "Skill L
> evel 3" ///
>                4.round_wage_level "Skill Level 4" logimm "Log(H-1Bs)" ///
>                1.subcontractor "Subcontractor" 1.subcontractor_2019 "Subcontr
> actor") ///
>     se star(* 0.1 ** 0.05 *** 0.01) ///
>     stats(Year Occ CommuteZone N, fmt(%9.0fc) label("Year FE" "Occupation FE"
>  "Commuting Zone FE" "Observations")) ///
>     prehead("\begin{sidewaystable}\centering" "\def\sym#1{\ifmmode^{#1}\else\
> (^{#1}\)\fi}" "\caption{Effect of Labor Market Concentration on Wages}" "\beg
> in{tabular}{l*{6}{c}}" "\toprule") ///
>     postfoot("\bottomrule" "\multicolumn{7}{l}{\footnotesize Dependent variab
> le: Wage (dollars). Standard errors clustered by commuting zone in columns 2-
> 6.}\\" "\multicolumn{7}{l}{\footnotesize Reference categories: Low HHI (<0.10
> ), Skill Level 1, Lead Firm.}\\" "\multicolumn{7}{l}{\footnotesize \sym{*} \(
> p<0.1\), \sym{**} \(p<0.05\), \sym{***} \(p<0.01\)}\\" "\end{tabular}" "\end{
> sidewaystable}") ///
>     nonumbers nonotes replace booktabs
(output written to ./output/tables/table2.tex)

. 
. * Also output as RTF for compatibility
. esttab t2_1 t2_2 t2_3 t2_4 t2_5 t2_6 using "$tables/table2.rtf", ///
>     keep(2.hhicat 3.hhicat 2.round_wage_level 3.round_wage_level 4.round_wage
> _level logimm 1.subcontractor 1.subcontractor_2019) ///
>     order(2.hhicat 3.hhicat 2.round_wage_level 3.round_wage_level 4.round_wag
> e_level logimm 1.subcontractor 1.subcontractor_2019) ///
>     coeflabels(2.hhicat "Moderate HHI" 3.hhicat "High HHI" ///
>                2.round_wage_level "Skill Level 2" 3.round_wage_level "Skill L
> evel 3" ///
>                4.round_wage_level "Skill Level 4" logimm "Log(H-1Bs)" ///
>                1.subcontractor "Subcontractor" 1.subcontractor_2019 "Subcontr
> actor") ///
>     se star(* 0.1 ** 0.05 *** 0.01) ///
>     stats(Year Occ CommuteZone N, fmt(%9.0fc) label("Year FE" "Occupation FE"
>  "Commuting Zone FE" "Observations")) ///
>     title("Effect of Labor Market Concentration on Wages") ///
>     mtitles("(1)" "(2)" "(3)" "(4)" "(5)" "(6)") ///
>     replace
(output written to ./output/tables/table2.rtf)

. 
. di "Table 2 saved to: $tables/table2.tex and $tables/table2.rtf"
Table 2 saved to: ./output/tables/table2.tex and ./output/tables/table2.rtf

. di ""


. di "VERIFY: Subcontractor coefficient should be approximately -8500"
VERIFY: Subcontractor coefficient should be approximately -8500

. di ""


. 
. 
. *----------------------------------------------------------------------------
> ---
. * TABLE 3: EFFECT OF LABOR MARKET POWER ON LOG(VIOLATIONS)
. * Source: code/01a_run_regressions.do
. * Verified: All 7 columns match paper exactly (Feb 2026)
. *
. * NOTE: This is Paper Table 3 (not Table 2)
. *
. * STER files: table3_col1.ster through table3_col7.ster
. *
. * Original STER file names:
. *   Col 1: foiareg_3_logviol_8_hhi.ster (CZ+Occ+Year, HHI only)
. *   Col 2: foiareg_3_logviol_8_hhix.ster (CZ+Occ+Year, HHI×Sub interaction)
. *   Col 3: firmfeolslogviolD3wt1.ster (Firm FE, weighted)
. *   Col 4: firmfenonsubolslogviolC3wt1.ster (Lead firms, Occ FE only)
. *   Col 5: firmfenonsubolslogviolD3wt1.ster (Lead firms, full FE)
. *   Col 6: firmfesubolslogviolC3wt1.ster (Subcontractors, Occ FE only)
. *   Col 7: firmfesubolslogviolD3wt1.ster (Subcontractors, full FE)
. *----------------------------------------------------------------------------
> ---
. 
. di "===== TABLE 3: LOG(VIOLATIONS) REGRESSIONS ====="
===== TABLE 3: LOG(VIOLATIONS) REGRESSIONS =====

. 
. estimates clear

. 
. * Column 1: CZ/Occ/Year FE, HHI only
. est use $sters/table3_col1.ster

. qui est replay

. est sto tabB1

. local CommuteZone "Y"

. local Occ "Y"

. local Year "Y"

. local Firm "N"

. estadd local Firm "`Firm'"

added macro:
               e(Firm) : "N"

. estadd local Year "`Year'"

added macro:
               e(Year) : "Y"

. estadd local Occ "`Occ'"

added macro:
                e(Occ) : "Y"

. estadd local CommuteZone "`CommuteZone'"

added macro:
        e(CommuteZone) : "Y"

. 
. * Column 2: CZ/Occ/Year FE, HHI x Subcontractor interaction
. est use $sters/table3_col2.ster

. qui est replay

. est sto tabB2

. local CommuteZone "Y"

. local Occ "Y"

. local Year "Y"

. local Firm "N"

. estadd local Firm "`Firm'"

added macro:
               e(Firm) : "N"

. estadd local Year "`Year'"

added macro:
               e(Year) : "Y"

. estadd local Occ "`Occ'"

added macro:
                e(Occ) : "Y"

. estadd local CommuteZone "`CommuteZone'"

added macro:
        e(CommuteZone) : "Y"

. 
. * Column 3: Firm FE, pooled
. est use $sters/table3_col3.ster

. qui est replay

. est sto tabB3

. local Year "Y"

. local Occ "Y"

. local CommuteZone "N"

. local Firm "Y"

. estadd local Firm "`Firm'"

added macro:
               e(Firm) : "Y"

. estadd local Year "`Year'"

added macro:
               e(Year) : "Y"

. estadd local Occ "`Occ'"

added macro:
                e(Occ) : "Y"

. estadd local CommuteZone "`CommuteZone'"

added macro:
        e(CommuteZone) : "N"

. 
. * Column 4: Lead Firms, Occ FE only
. est use $sters/table3_col4.ster

. qui est replay

. est sto tabB5

. local Year "N"

. local Occ "Y"

. local CommuteZone "N"

. local Firm "Y"

. estadd local Firm "`Firm'"

added macro:
               e(Firm) : "Y"

. estadd local Year "`Year'"

added macro:
               e(Year) : "N"

. estadd local Occ "`Occ'"

added macro:
                e(Occ) : "Y"

. estadd local CommuteZone "`CommuteZone'"

added macro:
        e(CommuteZone) : "N"

. 
. * Column 5: Lead Firms, full FE
. est use $sters/table3_col5.ster

. qui est replay

. est sto tabB6

. local Year "Y"

. local Occ "Y"

. local CommuteZone "N"

. local Firm "Y"

. estadd local Firm "`Firm'"

added macro:
               e(Firm) : "Y"

. estadd local Year "`Year'"

added macro:
               e(Year) : "Y"

. estadd local Occ "`Occ'"

added macro:
                e(Occ) : "Y"

. estadd local CommuteZone "`CommuteZone'"

added macro:
        e(CommuteZone) : "N"

. 
. * Column 6: Subcontractors, Occ FE only
. est use $sters/table3_col6.ster

. qui est replay

. est sto tabB7

. local Year "N"

. local Occ "Y"

. local CommuteZone "N"

. local Firm "Y"

. estadd local Firm "`Firm'"

added macro:
               e(Firm) : "Y"

. estadd local Year "`Year'"

added macro:
               e(Year) : "N"

. estadd local Occ "`Occ'"

added macro:
                e(Occ) : "Y"

. estadd local CommuteZone "`CommuteZone'"

added macro:
        e(CommuteZone) : "N"

. 
. * Column 7: Subcontractors, full FE
. est use $sters/table3_col7.ster

. qui est replay

. est sto tabB8

. local Year "Y"

. local Occ "Y"

. local CommuteZone "N"

. local Firm "Y"

. estadd local Firm "`Firm'"

added macro:
               e(Firm) : "Y"

. estadd local Year "`Year'"

added macro:
               e(Year) : "Y"

. estadd local Occ "`Occ'"

added macro:
                e(Occ) : "Y"

. estadd local CommuteZone "`CommuteZone'"

added macro:
        e(CommuteZone) : "N"

. 
. * Output formatting - use sidewaystable for 8-column table
. local title "THE EFFECT OF LABOR MARKET POWER AND SUBCONTRACTOR STATUS ON LOG
> (1 + VIOLATIONS PER 1000 H-1BS)"

. local rename "rename(hhithreeyearavg HHI 1.subcontractor Subcontractor 1.subc
> ontractor#c.hhithreeyearavg SubcontractorXHHI logh1bs Log(H-1Bs))"

. local dropvars "drop(_cons *.year* *occ*) nobaselevels noomitted"

. local stuff "numbers label cells(b(fmt(a3) star) se(fmt(a3) par)) starlevels(
> * 0.1 ** 0.05 *** 0.01)"

. local prehead "prehead(\begin{sidewaystable}\centering \caption{`title'}\cent
> ering\medskip \begin{tabular}{lcccccccc} \hline \hline) mlabels(none)"

. local postfoot "postfoot(\hline \hline \end{tabular} \end{sidewaystable})"

. local addons "`prehead' style(tex) `stuff' substitute(r2 R-Squared chi2 Chi-S
> q. _ \_ hhi HHI logh1bs Log(H-1Bs) ur\_rate URRate dep Dependence sub Subcont
> ractor (mean) banana Per. banana table\_viol banana viol banana banana ) `pos
> tfoot'"

. 
. estout tabB* using $tables/table3.tex, replace `dropvars' `rename' ///
>   order(HHI Subcontractor SubcontractorXHHI Log(H-1Bs)) `addons' ///
>   prefoot(\hline) stats(Year Occ CommuteZone Firm r2 p k_absorb N, fmt(%9.2gc
>  %9.2f %9.2fc %9.2fc %9.2fc %9.0fc %9.0fc))
(output written to ./output/tables/table3.tex)

. 
. di "Table 3 saved to: $tables/table3.tex"
Table 3 saved to: ./output/tables/table3.tex

. 
. *----------------------------------------------------------------------------
> ---
. * TABLE 4: IV REGRESSION - LOG(VIOLATIONS)
. * Source: dos/iv_regs_aug_25.do
. * DV: Log(1+1000*(Violations/H1Bs))
. * Method: Instrumental Variables (2SLS)
. * Instrument: Lagged HHI from prior year
. *
. * EXPECTED HHI coefficients: -0.247***, -0.230***, -0.350***, -0.257***,
. *                            -0.364***, -0.304***, -0.236***, -0.308***
. *
. * Fixed Effects by Column:
. *   Col 1: No FE
. *   Col 2: Year FE
. *   Col 3: Occupation FE
. *   Col 4: Commuting Zone FE
. *   Col 5: Occ + CZ FE
. *   Col 6: Year + Occ FE
. *   Col 7: Year + CZ FE
. *   Col 8: Year + Occ + CZ FE
. *
. * STER files: table4_col1.ster through table4_col8.ster
. * Verified: All 8 columns match paper exactly (Feb 2026)
. *----------------------------------------------------------------------------
> ---
. 
. di "===== TABLE 4: IV REGRESSION - LOG(VIOLATIONS) ====="
===== TABLE 4: IV REGRESSION - LOG(VIOLATIONS) =====

. 
. estimates clear

. 
. * Load .ster files (verified to match paper)
. est use $sters/table4_col1.ster

. qui est replay

. est sto tabC1

. estadd local Year "N"

added macro:
               e(Year) : "N"

. estadd local Occ "N"

added macro:
                e(Occ) : "N"

. estadd local CommuteZone "N"

added macro:
        e(CommuteZone) : "N"

. 
. est use $sters/table4_col2.ster

. qui est replay

. est sto tabC2

. estadd local Year "Y"

added macro:
               e(Year) : "Y"

. estadd local Occ "N"

added macro:
                e(Occ) : "N"

. estadd local CommuteZone "N"

added macro:
        e(CommuteZone) : "N"

. 
. est use $sters/table4_col3.ster

. qui est replay

. est sto tabC3

. estadd local Year "N"

added macro:
               e(Year) : "N"

. estadd local Occ "Y"

added macro:
                e(Occ) : "Y"

. estadd local CommuteZone "N"

added macro:
        e(CommuteZone) : "N"

. 
. est use $sters/table4_col4.ster

. qui est replay

. est sto tabC4

. estadd local Year "N"

added macro:
               e(Year) : "N"

. estadd local Occ "N"

added macro:
                e(Occ) : "N"

. estadd local CommuteZone "Y"

added macro:
        e(CommuteZone) : "Y"

. 
. est use $sters/table4_col5.ster

. qui est replay

. est sto tabC5

. estadd local Year "N"

added macro:
               e(Year) : "N"

. estadd local Occ "Y"

added macro:
                e(Occ) : "Y"

. estadd local CommuteZone "Y"

added macro:
        e(CommuteZone) : "Y"

. 
. est use $sters/table4_col6.ster

. qui est replay

. est sto tabC6

. estadd local Year "Y"

added macro:
               e(Year) : "Y"

. estadd local Occ "Y"

added macro:
                e(Occ) : "Y"

. estadd local CommuteZone "N"

added macro:
        e(CommuteZone) : "N"

. 
. est use $sters/table4_col7.ster

. qui est replay

. est sto tabC7

. estadd local Year "Y"

added macro:
               e(Year) : "Y"

. estadd local Occ "N"

added macro:
                e(Occ) : "N"

. estadd local CommuteZone "Y"

added macro:
        e(CommuteZone) : "Y"

. 
. est use $sters/table4_col8.ster

. qui est replay

. est sto tabC8

. estadd local Year "Y"

added macro:
               e(Year) : "Y"

. estadd local Occ "Y"

added macro:
                e(Occ) : "Y"

. estadd local CommuteZone "Y"

added macro:
        e(CommuteZone) : "Y"

. 
. * Output table - keep only key variables for IV regressions
. * Note: IV regressions don't include subcontractor as a variable
. esttab tabC* using "$tables/table4.tex", replace ///
>     keep(hhithreeyearavg logh1bs) ///
>     order(hhithreeyearavg logh1bs) ///
>     coeflabels(hhithreeyearavg "HHI" logh1bs "Log(H-1Bs)") ///
>     se star(* 0.1 ** 0.05 *** 0.01) ///
>     stats(Year Occ CommuteZone N widstat jp, fmt(%9.0fc) label("Year FE" "Occ
> upation FE" "Commuting Zone FE" "Observations" "Kleibergen-Paap F" "Hansen J 
> p-value")) ///
>     prehead("\begin{sidewaystable}[htbp]\centering" "\def\sym#1{\ifmmode^{#1}
> \else\(^{#1}\)\fi}" "\caption{IV Regression: Effect of Labor Market Power on 
> Log(Violations)}" "\begin{tabular}{l*{8}{c}}" "\toprule") ///
>     postfoot("\bottomrule" "\multicolumn{9}{l}{\footnotesize Dependent variab
> le: Log(1+1000*(Violations/H1Bs)). IV regression using lagged HHI as instrume
> nt.}\\" "\multicolumn{9}{l}{\footnotesize \sym{*} \(p<0.1\), \sym{**} \(p<0.0
> 5\), \sym{***} \(p<0.01\)}\\" "\end{tabular}" "\end{sidewaystable}") ///
>     nonumbers nonotes booktabs
(output written to ./output/tables/table4.tex)

. 
. di "Table 4 saved to: $tables/table4.tex"
Table 4 saved to: ./output/tables/table4.tex

. di ""


. di "VERIFY: HHI coefficients should be: -0.247, -0.230, -0.350, -0.257, -0.36
> 4, -0.304, -0.236, -0.308"
VERIFY: HHI coefficients should be: -0.247, -0.230, -0.350, -0.257, -0.364, -0.
> 304, -0.236, -0.308

. di ""


. 
. 
. *----------------------------------------------------------------------------
> ---
. * TABLE A1: NEGATIVE BINOMIAL REGRESSION
. * Source: dos/pub_tables.do lines 251-362
. * Verified: All 7 columns match paper exactly
. *
. * STER files: tablea1_col1.ster through tablea1_col7.ster
. *
. * Original STER file names:
. *   Col 1: foianbr_3_viol_8_hhi.ster (CZ+Occ+Year, HHI only)
. *   Col 2: foianbr_3_viol_8_hhix.ster (CZ+Occ+Year, HHI×Sub interaction)
. *   Col 3: firmfextnbregviolD3wt2.ster (Firm FE NB)
. *   Col 4: firmfenonsubxtnbregviolC3wt2.ster (Lead firms, Occ FE)
. *   Col 5: firmfenonsubxtnbregviolD3wt2.ster (Lead firms, full FE)
. *   Col 6: firmfesubxtnbregviolC3wt2.ster (Subcontractors, Occ FE)
. *   Col 7: firmfesubxtnbregviolD3wt2.ster (Subcontractors, full FE)
. *----------------------------------------------------------------------------
> ---
. * COMMENTED-OUT CODE TO REPRODUCE FROM SCRATCH:
. * Note: Negative binomial regressions can be slow and may require iterations
. *----------------------------------------------------------------------------
> ---
. 
. di "===== TABLE A1: NEGATIVE BINOMIAL REGRESSIONS ====="
===== TABLE A1: NEGATIVE BINOMIAL REGRESSIONS =====

. 
. estimates clear

. 
. * Column 1: CZ/Occ/Year, NB regression
. est use $sters/tablea1_col1.ster

. qui est replay

. est sto tabC1

. local CommuteZone "Y"

. local Occ "Y"

. local Year "Y"

. local Firm "N"

. estadd local Firm "`Firm'"

added macro:
               e(Firm) : "N"

. estadd local Year "`Year'"

added macro:
               e(Year) : "Y"

. estadd local Occ "`Occ'"

added macro:
                e(Occ) : "Y"

. estadd local CommuteZone "`CommuteZone'"

added macro:
        e(CommuteZone) : "Y"

. 
. * Column 2: With interaction
. est use $sters/tablea1_col2.ster

. qui est replay

. est sto tabC2

. local CommuteZone "Y"

. local Occ "Y"

. local Year "Y"

. local Firm "N"

. estadd local Firm "`Firm'"

added macro:
               e(Firm) : "N"

. estadd local Year "`Year'"

added macro:
               e(Year) : "Y"

. estadd local Occ "`Occ'"

added macro:
                e(Occ) : "Y"

. estadd local CommuteZone "`CommuteZone'"

added macro:
        e(CommuteZone) : "Y"

. 
. * Column 3: Firm FE NB
. est use $sters/tablea1_col3.ster

. qui est replay

. est sto tabC3

. local Year "Y"

. local Occ "Y"

. local CommuteZone "N"

. local Firm "Y"

. estadd local Firm "`Firm'"

added macro:
               e(Firm) : "Y"

. estadd local Year "`Year'"

added macro:
               e(Year) : "Y"

. estadd local Occ "`Occ'"

added macro:
                e(Occ) : "Y"

. estadd local CommuteZone "`CommuteZone'"

added macro:
        e(CommuteZone) : "N"

. 
. * Column 4: Lead firms, Occ FE only
. est use $sters/tablea1_col4.ster

. qui est replay

. est sto tabC5

. local Year "N"

. local Occ "Y"

. local CommuteZone "N"

. local Firm "Y"

. estadd local Firm "`Firm'"

added macro:
               e(Firm) : "Y"

. estadd local Year "`Year'"

added macro:
               e(Year) : "N"

. estadd local Occ "`Occ'"

added macro:
                e(Occ) : "Y"

. estadd local CommuteZone "`CommuteZone'"

added macro:
        e(CommuteZone) : "N"

. 
. * Column 5: Lead firms, full FE
. est use $sters/tablea1_col5.ster

. qui est replay

. est sto tabC6

. local Year "Y"

. local Occ "Y"

. local CommuteZone "N"

. local Firm "Y"

. estadd local Firm "`Firm'"

added macro:
               e(Firm) : "Y"

. estadd local Year "`Year'"

added macro:
               e(Year) : "Y"

. estadd local Occ "`Occ'"

added macro:
                e(Occ) : "Y"

. estadd local CommuteZone "`CommuteZone'"

added macro:
        e(CommuteZone) : "N"

. 
. * Column 6: Subcontractors, Occ FE only
. est use $sters/tablea1_col6.ster

. qui est replay

. est sto tabC7

. local Year "N"

. local Occ "Y"

. local CommuteZone "N"

. local Firm "Y"

. estadd local Firm "`Firm'"

added macro:
               e(Firm) : "Y"

. estadd local Year "`Year'"

added macro:
               e(Year) : "N"

. estadd local Occ "`Occ'"

added macro:
                e(Occ) : "Y"

. estadd local CommuteZone "`CommuteZone'"

added macro:
        e(CommuteZone) : "N"

. 
. * Column 7: Subcontractors, full FE
. est use $sters/tablea1_col7.ster

. qui est replay

. est sto tabC8

. local Year "Y"

. local Occ "Y"

. local CommuteZone "N"

. local Firm "Y"

. estadd local Firm "`Firm'"

added macro:
               e(Firm) : "Y"

. estadd local Year "`Year'"

added macro:
               e(Year) : "Y"

. estadd local Occ "`Occ'"

added macro:
                e(Occ) : "Y"

. estadd local CommuteZone "`CommuteZone'"

added macro:
        e(CommuteZone) : "N"

. 
. * Output formatting
. local title "THE EFFECT OF LABOR MARKET POWER AND SUBCONTRACTOR STATUS ON WAG
> E AND HOUR VIOLATIONS"

. local rename "rename(hhithreeyearavg HHI 1.subcontractor Subcontractor 1.subc
> ontractor#c.hhithreeyearavg SubcontractorXHHI logh1bs Log(H-1Bs))"

. local dropvars "drop(_cons *cz90* *.year* *occ*) nobaselevels noomitted"

. local stuff "numbers label cells(b(fmt(a3) star) se(fmt(a3) par)) starlevels(
> * 0.1 ** 0.05 *** 0.01)"

. local prehead "prehead(\begin{sidewaystable}\centering \caption{`title'}\cent
> ering\medskip \begin{tabular}{lcccccccc} \hline \hline) mlabels(none)"

. local postfoot "postfoot(\hline \hline \end{tabular} \end{sidewaystable})"

. local addons "`prehead' style(tex) `stuff' substitute(r2 R-Squared chi2 Chi-S
> q. _ \_ hhi HHI logh1bs Log(H-1Bs) ur\_rate URRate dep Dependence sub Subcont
> ractor (mean) banana Per. banana table\_viol banana viol banana banana ) `pos
> tfoot'"

. 
. estout tabC* using $tables/table_a1.tex, replace `dropvars' `rename' ///
>   order(HHI Subcontractor SubcontractorXHHI Log(H-1Bs)) `addons' ///
>   prefoot(\hline) stats(Year Occ CommuteZone Firm N, fmt(%9.2gc %9.0fc)) efor
> m
(output written to ./output/tables/table_a1.tex)

. 
. di "Table A1 saved to: $tables/table_a1.tex"
Table A1 saved to: ./output/tables/table_a1.tex

. 
. *----------------------------------------------------------------------------
> ---
. * TABLE 5: MARGINAL EFFECTS - CHANGES IN PROBABILITY
. * Source: 01a_run_regressions.do (probit models)
. *
. * Panel A: Change in Probability a Firm Ever Violates (company-level probit)
. * Panel B: Change in Probability a Firm Violates at t (panel probit)
. *
. * NOTE: Probit models are run in 01a_run_regressions.do and output .tex files
>  directly.
. * The .tex files are pre-generated and just need to be included in the LaTeX 
> document.
. *----------------------------------------------------------------------------
> ---
. 
. di "===== TABLE 5: MARGINAL EFFECTS ====="
===== TABLE 5: MARGINAL EFFECTS =====

. di "Pre-generated by 01a_run_regressions.do:"
Pre-generated by 01a_run_regressions.do:

. di "  - $tables/table5_panelA.tex"
  - ./output/tables/table5_panelA.tex

. di "  - $tables/table5_panelB.tex"
  - ./output/tables/table5_panelB.tex

. di "  - $tables/table5a.tex (combined)"
  - ./output/tables/table5a.tex (combined)

. di ""


. 
. *----------------------------------------------------------------------------
> ---
. * TABLE 6 (5b): MARGINAL EFFECTS - PROBABILITIES AT CRITICAL VALUES
. * Source: 01a_run_regressions.do (probit models)
. *
. * Panel A: Probability a Firm Ever Violates
. * Panel B: Probability a Firm Violates at time t
. *
. * NOTE: Probit models are run in 01a_run_regressions.do and output .tex files
>  directly.
. *----------------------------------------------------------------------------
> ---
. 
. di "===== TABLE 6: PROBABILITIES AT CRITICAL VALUES ====="
===== TABLE 6: PROBABILITIES AT CRITICAL VALUES =====

. di "Pre-generated by 01a_run_regressions.do:"
Pre-generated by 01a_run_regressions.do:

. di "  - $tables/table5b_panelA.tex"
  - ./output/tables/table5b_panelA.tex

. di "  - $tables/table5b_panelB.tex"
  - ./output/tables/table5b_panelB.tex

. di ""


. 
. *----------------------------------------------------------------------------
> ---
. * TABLE A.2: WEIGHTED REGRESSIONS - LOG(VIOLATIONS)
. * Source: 01a_run_regressions.do (pre-computed .ster files)
. *
. * Panel A: Within Firm Ordinary Least Squares (Firm Fixed Effects)
. * Panel B: Between Firm Ordinary Least Squares (Pooled OLS)
. *
. * Paper shows:
. *   Panel A: N = 4,746,563, HHI coefficients: -0.0999**, -0.0377, -0.106**, -
> 0.0463
. *   Panel B: N = 4,746,573, HHI coefficients: -0.118**, -0.0718*, -0.108**, -
> 0.0708*
. *
. * STER files: tablea2a_col1-4.ster (Panel A), tablea2b_col1-4.ster (Panel B)
. *----------------------------------------------------------------------------
> ---
. 
. di "===== TABLE A.2: LOADING FROM PRE-COMPUTED .STER FILES ====="
===== TABLE A.2: LOADING FROM PRE-COMPUTED .STER FILES =====

. 
. *----------------------------------------------------------------------------
> ---
. * PANEL A: Within Firm Ordinary Least Squares (Firm Fixed Effects)
. *----------------------------------------------------------------------------
> ---
. 
. di "===== TABLE A.2 PANEL A: WITHIN FIRM OLS (FIRM FE) ====="
===== TABLE A.2 PANEL A: WITHIN FIRM OLS (FIRM FE) =====

. 
. estimates clear

. 
. * Load from pre-computed .ster files
. est use $sters/tablea2a_col1.ster

. qui est replay

. est sto tabE1

. estadd local Year "N"

added macro:
               e(Year) : "N"

. estadd local Occ "N"

added macro:
                e(Occ) : "N"

. estadd local Firm "Y"

added macro:
               e(Firm) : "Y"

. 
. est use $sters/tablea2a_col2.ster

. qui est replay

. est sto tabE2

. estadd local Year "Y"

added macro:
               e(Year) : "Y"

. estadd local Occ "N"

added macro:
                e(Occ) : "N"

. estadd local Firm "Y"

added macro:
               e(Firm) : "Y"

. 
. est use $sters/tablea2a_col3.ster

. qui est replay

. est sto tabE3

. estadd local Year "N"

added macro:
               e(Year) : "N"

. estadd local Occ "Y"

added macro:
                e(Occ) : "Y"

. estadd local Firm "Y"

added macro:
               e(Firm) : "Y"

. 
. est use $sters/tablea2a_col4.ster

. qui est replay

. est sto tabE4

. estadd local Year "Y"

added macro:
               e(Year) : "Y"

. estadd local Occ "Y"

added macro:
                e(Occ) : "Y"

. estadd local Firm "Y"

added macro:
               e(Firm) : "Y"

. 
. * Output formatting for Panel A
. local title "Firm, Occupation Level: Within Firm OLS: DV: Log(1+ 1000*(Violat
> ions/H1Bs))"

. local rename "rename(hhithreeyearavg HHI logh1bs log(H1Bs))"

. local keeps "HHI log(H1Bs)"

. local stuff "numbers label cells(b(fmt(a3) star) se(fmt(a3) par)) starlevels(
> * 0.1 ** 0.05 *** 0.01)"

. local prehead "prehead(\begin{table}\centering \caption{`title'}\centering\me
> dskip \begin{tabular}{lccccc} \hline \hline) mlabels(none)"

. local postfoot "postfoot(\hline \hline \end{tabular} \end{table})"

. local addons "`prehead' style(tex) `stuff' substitute(r2 R-Squared _ \_) `pos
> tfoot'"

. 
. estout tabE* using $tables/table_a2_panelA.tex, replace `rename' keep(`keeps'
> ) order(`keeps') `addons' ///
>   prefoot(\hline) stats(Year Occ Firm r2 k_absorb N, fmt(%9.2gc %9.2f %9.0fc 
> %9.0fc))
(output written to ./output/tables/table_a2_panelA.tex)

. 
. di "Table A.2 Panel A saved to: $tables/table_a2_panelA.tex"
Table A.2 Panel A saved to: ./output/tables/table_a2_panelA.tex

. 
. *----------------------------------------------------------------------------
> ---
. * PANEL B: Between Firm Ordinary Least Squares (Pooled OLS)
. *----------------------------------------------------------------------------
> ---
. 
. di "===== TABLE A.2 PANEL B: BETWEEN FIRM OLS ====="
===== TABLE A.2 PANEL B: BETWEEN FIRM OLS =====

. 
. estimates clear

. 
. * Load from pre-computed .ster files
. est use $sters/tablea2b_col1.ster

. qui est replay

. est sto tabF1

. estadd local Year "N"

added macro:
               e(Year) : "N"

. estadd local Occ "N"

added macro:
                e(Occ) : "N"

. estadd local Firm "Y"

added macro:
               e(Firm) : "Y"

. 
. est use $sters/tablea2b_col2.ster

. qui est replay

. est sto tabF2

. estadd local Year "Y"

added macro:
               e(Year) : "Y"

. estadd local Occ "N"

added macro:
                e(Occ) : "N"

. estadd local Firm "Y"

added macro:
               e(Firm) : "Y"

. 
. est use $sters/tablea2b_col3.ster

. qui est replay

. est sto tabF3

. estadd local Year "N"

added macro:
               e(Year) : "N"

. estadd local Occ "Y"

added macro:
                e(Occ) : "Y"

. estadd local Firm "Y"

added macro:
               e(Firm) : "Y"

. 
. est use $sters/tablea2b_col4.ster

. qui est replay

. est sto tabF4

. estadd local Year "Y"

added macro:
               e(Year) : "Y"

. estadd local Occ "Y"

added macro:
                e(Occ) : "Y"

. estadd local Firm "Y"

added macro:
               e(Firm) : "Y"

. 
. * Output formatting for Panel B - must rebuild prehead and addons with new ti
> tle
. local title "Firm, Occupation Level: Between Firm OLS: DV: Log(1+ 1000*(Viola
> tions/H1Bs))"

. local prehead "prehead(\begin{table}\centering \caption{`title'}\centering\me
> dskip \begin{tabular}{lccccc} \hline \hline) mlabels(none)"

. local addons "`prehead' style(tex) `stuff' substitute(r2 R-Squared _ \_) `pos
> tfoot'"

. 
. estout tabF* using $tables/table_a2_panelB.tex, replace `rename' keep(`keeps'
> ) order(`keeps') `addons' ///
>   prefoot(\hline) stats(Year Occ Firm r2 N, fmt(%9.2gc %9.2f %9.0fc))
(output written to ./output/tables/table_a2_panelB.tex)

. 
. di "Table A.2 Panel B saved to: $tables/table_a2_panelB.tex"
Table A.2 Panel B saved to: ./output/tables/table_a2_panelB.tex

. 
. *----------------------------------------------------------------------------
> ---
. * TABLE A.3: WEIGHTED REGRESSIONS - LOG(BACK WAGES)
. * Source: 01a_run_regressions.do (pre-computed .ster files)
. *
. * Panel A: Within Firm Ordinary Least Squares (Firm Fixed Effects)
. * Panel B: Between Firm Ordinary Least Squares (Pooled OLS)
. *
. * Paper shows:
. *   Panel A: N = 4,746,618, HHI coefficients: -0.174**, -0.0395, -0.169*, -0.
> 0416
. *   Panel B: N = 4,746,573, HHI coefficients: -0.210**, -0.118, -0.188**, -0.
> 0870
. *
. * STER files: tablea3a_col1-4.ster (Panel A), tablea3b_col1-4.ster (Panel B)
. *----------------------------------------------------------------------------
> ---
. 
. di "===== TABLE A.3: LOADING FROM PRE-COMPUTED .STER FILES ====="
===== TABLE A.3: LOADING FROM PRE-COMPUTED .STER FILES =====

. 
. *----------------------------------------------------------------------------
> ---
. * PANEL A: Within Firm Ordinary Least Squares (Firm Fixed Effects)
. *----------------------------------------------------------------------------
> ---
. 
. di "===== TABLE A.3 PANEL A: WITHIN FIRM OLS (FIRM FE) ====="
===== TABLE A.3 PANEL A: WITHIN FIRM OLS (FIRM FE) =====

. 
. estimates clear

. 
. * Load from pre-computed .ster files
. est use $sters/tablea3a_col1.ster

. qui est replay

. est sto tabG1

. estadd local Year "N"

added macro:
               e(Year) : "N"

. estadd local Occ "N"

added macro:
                e(Occ) : "N"

. estadd local Firm "Y"

added macro:
               e(Firm) : "Y"

. 
. est use $sters/tablea3a_col2.ster

. qui est replay

. est sto tabG2

. estadd local Year "Y"

added macro:
               e(Year) : "Y"

. estadd local Occ "N"

added macro:
                e(Occ) : "N"

. estadd local Firm "Y"

added macro:
               e(Firm) : "Y"

. 
. est use $sters/tablea3a_col3.ster

. qui est replay

. est sto tabG3

. estadd local Year "N"

added macro:
               e(Year) : "N"

. estadd local Occ "Y"

added macro:
                e(Occ) : "Y"

. estadd local Firm "Y"

added macro:
               e(Firm) : "Y"

. 
. est use $sters/tablea3a_col4.ster

. qui est replay

. est sto tabG4

. estadd local Year "Y"

added macro:
               e(Year) : "Y"

. estadd local Occ "Y"

added macro:
                e(Occ) : "Y"

. estadd local Firm "Y"

added macro:
               e(Firm) : "Y"

. 
. * Output formatting for Panel A
. local title "Firm, Occupation Level: Within Firm OLS: DV: Log(1+1000*(Back Wa
> ges/H1Bs))"

. local rename "rename(hhithreeyearavg HHI logh1bs log(H1Bs))"

. local keeps "HHI log(H1Bs)"

. local stuff "numbers label cells(b(fmt(a3) star) se(fmt(a3) par)) starlevels(
> * 0.1 ** 0.05 *** 0.01)"

. local prehead "prehead(\begin{table}\centering \caption{`title'}\centering\me
> dskip \begin{tabular}{lccccc} \hline \hline) mlabels(none)"

. local postfoot "postfoot(\hline \hline \end{tabular} \end{table})"

. local addons "`prehead' style(tex) `stuff' substitute(r2 R-Squared _ \_) `pos
> tfoot'"

. 
. estout tabG* using $tables/table_a3_panelA.tex, replace `rename' keep(`keeps'
> ) order(`keeps') `addons' ///
>   prefoot(\hline) stats(Year Occ Firm r2 k_absorb N, fmt(%9.2gc %9.2f %9.0fc 
> %9.0fc))
(output written to ./output/tables/table_a3_panelA.tex)

. 
. di "Table A.3 Panel A saved to: $tables/table_a3_panelA.tex"
Table A.3 Panel A saved to: ./output/tables/table_a3_panelA.tex

. 
. *----------------------------------------------------------------------------
> ---
. * PANEL B: Between Firm Ordinary Least Squares (Pooled OLS)
. *----------------------------------------------------------------------------
> ---
. 
. di "===== TABLE A.3 PANEL B: BETWEEN FIRM OLS ====="
===== TABLE A.3 PANEL B: BETWEEN FIRM OLS =====

. 
. estimates clear

. 
. * Load from pre-computed .ster files
. est use $sters/tablea3b_col1.ster

. qui est replay

. est sto tabH1

. estadd local Year "N"

added macro:
               e(Year) : "N"

. estadd local Occ "N"

added macro:
                e(Occ) : "N"

. estadd local Firm "Y"

added macro:
               e(Firm) : "Y"

. 
. est use $sters/tablea3b_col2.ster

. qui est replay

. est sto tabH2

. estadd local Year "Y"

added macro:
               e(Year) : "Y"

. estadd local Occ "N"

added macro:
                e(Occ) : "N"

. estadd local Firm "Y"

added macro:
               e(Firm) : "Y"

. 
. est use $sters/tablea3b_col3.ster

. qui est replay

. est sto tabH3

. estadd local Year "N"

added macro:
               e(Year) : "N"

. estadd local Occ "Y"

added macro:
                e(Occ) : "Y"

. estadd local Firm "Y"

added macro:
               e(Firm) : "Y"

. 
. est use $sters/tablea3b_col4.ster

. qui est replay

. est sto tabH4

. estadd local Year "Y"

added macro:
               e(Year) : "Y"

. estadd local Occ "Y"

added macro:
                e(Occ) : "Y"

. estadd local Firm "Y"

added macro:
               e(Firm) : "Y"

. 
. * Output formatting for Panel B - must rebuild prehead and addons with new ti
> tle
. local title "Firm, Occupation Level: Between Firm OLS: DV: Log(1+1000*(Back W
> ages/H1Bs))"

. local prehead "prehead(\begin{table}\centering \caption{`title'}\centering\me
> dskip \begin{tabular}{lccccc} \hline \hline) mlabels(none)"

. local addons "`prehead' style(tex) `stuff' substitute(r2 R-Squared _ \_) `pos
> tfoot'"

. 
. estout tabH* using $tables/table_a3_panelB.tex, replace `rename' keep(`keeps'
> ) order(`keeps') `addons' ///
>   prefoot(\hline) stats(Year Occ Firm r2 N, fmt(%9.2gc %9.2f %9.0fc))
(output written to ./output/tables/table_a3_panelB.tex)

. 
. di "Table A.3 Panel B saved to: $tables/table_a3_panelB.tex"
Table A.3 Panel B saved to: ./output/tables/table_a3_panelB.tex

. 
. *----------------------------------------------------------------------------
> ---
. * TABLE A.4: UNWEIGHTED REGRESSIONS - LOG(BACK WAGES)
. * Source: dos/pub_tables.do, obes_dos/obes_firmlevel_table.do
. * Original tex: pubtable3.tex (combines multiple source tables)
. * Verified: All 7 columns match paper Appendix Table 4 exactly
. *
. * Column mapping:
. *   Col 1: table4b col 4 (RE OLS) - HHI = -0.0178*
. *   Col 2: foialogbw_reg_hhix_catset3 col 8 (with interaction) - HHI = 0.0029
> 6
. *   Col 3: table4a col 4 (FE OLS) - HHI = -0.0213
. *   Col 4: fenonsub_table5b_a col 3 (Lead Firms, FE, Occ) - HHI = -0.0132**
. *   Col 5: fenonsub_table5b_a col 4 (Lead Firms, FE, Year+Occ) - HHI = -0.006
> 57
. *   Col 6: fesub_table5b_a col 3 (Subcontractors, FE, Occ) - HHI = -0.229***
. *   Col 7: fesub_table5b_a col 4 (Subcontractors, FE, Year+Occ) - HHI = -0.08
> 53
. *
. * STER files: tablea4_col1.ster through tablea4_col7.ster
. * Original STER file names:
. *   Col 1: firmreolslogbwD3wt2.ster
. *   Col 2: foiareg_3_logbw_8_hhix.ster
. *   Col 3: firmfeolslogbwD3wt2.ster
. *   Col 4: firmfenonsubolslogbwC3wt2.ster
. *   Col 5: firmfenonsubolslogbwD3wt2.ster
. *   Col 6: firmfesubolslogbwC3wt2.ster
. *   Col 7: firmfesubolslogbwD3wt2.ster
. *----------------------------------------------------------------------------
> ---
. * COMMENTED-OUT CODE TO REPRODUCE FROM SCRATCH:
. *----------------------------------------------------------------------------
> ---
. 
. di "===== TABLE A.4: UNWEIGHTED LOG(BACK WAGES) ====="
===== TABLE A.4: UNWEIGHTED LOG(BACK WAGES) =====

. 
. estimates clear

. 
. * Column 1: Random Effects OLS (Year+Occ+Firm)
. est use $sters/tablea4_col1.ster

. qui est replay

. est sto tabI1

. local Year "Y"

. local Occ "Y"

. local CommuteZone "N"

. local Firm "N"

. estadd local Firm "`Firm'"

added macro:
               e(Firm) : "N"

. estadd local Year "`Year'"

added macro:
               e(Year) : "Y"

. estadd local Occ "`Occ'"

added macro:
                e(Occ) : "Y"

. estadd local CommuteZone "`CommuteZone'"

added macro:
        e(CommuteZone) : "N"

. 
. * Column 2: CZ/Occ/Year with HHI x Subcontractor interaction
. est use $sters/tablea4_col2.ster

. qui est replay

. est sto tabI2

. local Year "Y"

. local Occ "Y"

. local CommuteZone "Y"

. local Firm "N"

. estadd local Firm "`Firm'"

added macro:
               e(Firm) : "N"

. estadd local Year "`Year'"

added macro:
               e(Year) : "Y"

. estadd local Occ "`Occ'"

added macro:
                e(Occ) : "Y"

. estadd local CommuteZone "`CommuteZone'"

added macro:
        e(CommuteZone) : "Y"

. 
. * Column 3: Fixed Effects OLS (Year+Occ+Firm)
. est use $sters/tablea4_col3.ster

. qui est replay

. est sto tabI3

. local Year "Y"

. local Occ "Y"

. local CommuteZone "N"

. local Firm "Y"

. estadd local Firm "`Firm'"

added macro:
               e(Firm) : "Y"

. estadd local Year "`Year'"

added macro:
               e(Year) : "Y"

. estadd local Occ "`Occ'"

added macro:
                e(Occ) : "Y"

. estadd local CommuteZone "`CommuteZone'"

added macro:
        e(CommuteZone) : "N"

. 
. * Column 4: Lead Firms, FE OLS, Occ only
. est use $sters/tablea4_col4.ster

. qui est replay

. est sto tabI5

. local Year "N"

. local Occ "Y"

. local CommuteZone "N"

. local Firm "Y"

. estadd local Firm "`Firm'"

added macro:
               e(Firm) : "Y"

. estadd local Year "`Year'"

added macro:
               e(Year) : "N"

. estadd local Occ "`Occ'"

added macro:
                e(Occ) : "Y"

. estadd local CommuteZone "`CommuteZone'"

added macro:
        e(CommuteZone) : "N"

. 
. * Column 5: Lead Firms, FE OLS, Year+Occ
. est use $sters/tablea4_col5.ster

. qui est replay

. est sto tabI6

. local Year "Y"

. local Occ "Y"

. local CommuteZone "N"

. local Firm "Y"

. estadd local Firm "`Firm'"

added macro:
               e(Firm) : "Y"

. estadd local Year "`Year'"

added macro:
               e(Year) : "Y"

. estadd local Occ "`Occ'"

added macro:
                e(Occ) : "Y"

. estadd local CommuteZone "`CommuteZone'"

added macro:
        e(CommuteZone) : "N"

. 
. * Column 6: Subcontractors, FE OLS, Occ only
. est use $sters/tablea4_col6.ster

. qui est replay

. est sto tabI7

. local Year "N"

. local Occ "Y"

. local CommuteZone "N"

. local Firm "Y"

. estadd local Firm "`Firm'"

added macro:
               e(Firm) : "Y"

. estadd local Year "`Year'"

added macro:
               e(Year) : "N"

. estadd local Occ "`Occ'"

added macro:
                e(Occ) : "Y"

. estadd local CommuteZone "`CommuteZone'"

added macro:
        e(CommuteZone) : "N"

. 
. * Column 7: Subcontractors, FE OLS, Year+Occ
. est use $sters/tablea4_col7.ster

. qui est replay

. est sto tabI8

. local Year "Y"

. local Occ "Y"

. local CommuteZone "N"

. local Firm "Y"

. estadd local Firm "`Firm'"

added macro:
               e(Firm) : "Y"

. estadd local Year "`Year'"

added macro:
               e(Year) : "Y"

. estadd local Occ "`Occ'"

added macro:
                e(Occ) : "Y"

. estadd local CommuteZone "`CommuteZone'"

added macro:
        e(CommuteZone) : "N"

. 
. * Output formatting
. local title "THE EFFECT OF LABOR MARKET POWER AND SUBCONTRACTOR STATUS ON LOG
> (1+ BACK WAGES PER 1000 H-1BS)"

. local rename "rename(hhithreeyearavg HHI 1.subcontractor Subcontractor 1.subc
> ontractor#c.hhithreeyearavg SubcontractorXHHI logh1bs Log(H-1Bs))"

. local dropvars "drop(_cons *cz90* *.year* *occ*) nobaselevels noomitted"

. local stuff "numbers label cells(b(fmt(a3) star) se(fmt(a3) par)) starlevels(
> * 0.1 ** 0.05 *** 0.01)"

. local prehead "prehead(\begin{sidewaystable}\centering \caption{`title'}\cent
> ering\medskip \begin{tabular}{lcccccccc} \hline \hline) mlabels(none)"

. local postfoot "postfoot(\hline \hline \end{tabular} \end{sidewaystable})"

. local addons "`prehead' style(tex) `stuff' substitute(r2 R-Squared chi2 Chi-S
> q. _ \_ hhi HHI logh1bs Log(H-1Bs) ur\_rate URRate dep Dependence sub Subcont
> ractor (mean) banana Per. banana table\_viol banana viol banana banana ) `pos
> tfoot'"

. 
. estout tabI* using $tables/table_a4.tex, replace `dropvars' `rename' ///
>   order(HHI Subcontractor SubcontractorXHHI Log(H-1Bs)) `addons' ///
>   prefoot(\hline) stats(Year Occ CommuteZone Firm r2 N, fmt(%9.2gc %9.2f %9.0
> fc))
(output written to ./output/tables/table_a4.tex)

. 
. di "Table A.4 saved to: $tables/table_a4.tex"
Table A.4 saved to: ./output/tables/table_a4.tex

. 
. *----------------------------------------------------------------------------
> ---
. * TABLE A.5: WEIGHTED REGRESSIONS - LOG(BACK WAGES/PROMISED WAGES)
. *
. * Panel A: Within Firm Ordinary Least Squares (Firm Fixed Effects)
. * Panel B: Between Firm Ordinary Least Squares (Pooled OLS with CZ FE)
. *
. * Paper shows:
. *   Panel A: N = 1,351,775, HHI coefficients: -0.0173***, -0.00821***, -0.016
> 4***, -0.00782***
. *   Panel B: N = 1,351,786, HHI coefficients: -0.00957***, -0.00444***, -0.00
> 969***, -0.00415***
. *
. * ROOT CAUSE OF ORIGINAL FAILURE:
. * The original code used [fw=fw_h1bs] (frequency weights), which caused Stata
>  to report
. * N = sum of weights (4.7M) instead of observation count (1.35M).
. * The paper used analytical weights [aw=nbr_h1bs] which reports actual N.
. *
. * SOLUTION: Use original .ster files that match the paper exactly.
. * These files were created with analytical weights and produce exact matches.
. * Files: tablea5a_col[1-4].ster (Panel A), tablea5b_col[1-4].ster (Panel B)
. *
. *----------------------------------------------------------------------------
> ---
. * COMMENTED-OUT CODE TO REPRODUCE FROM SCRATCH:
. * Uncomment this section if you want to regenerate the regressions instead of
. * loading .ster files. Uses analytical weights [aw=nbr_h1bs] to match paper.
. *
. * NOTE: This code has NOT been verified to produce exact matches. The .ster
. * files are the authoritative source for the paper's results.
. *----------------------------------------------------------------------------
> ---
. *----------------------------------------------------------------------------
> ---
. 
. di "===== TABLE A.5: LOADING ORIGINAL STER FILES FOR LOG(BW/PW) ====="
===== TABLE A.5: LOADING ORIGINAL STER FILES FOR LOG(BW/PW) =====

. 
. *----------------------------------------------------------------------------
> ---
. * PANEL A: Within Firm Ordinary Least Squares (Firm Fixed Effects)
. * Uses analytical weights [aw=nbr_h1bs] with firm FE absorbed
. * Files: tablea5a_col1.ster through tablea5a_col4.ster
. *----------------------------------------------------------------------------
> ---
. 
. di "===== TABLE A.5 PANEL A: WITHIN FIRM OLS (FIRM FE) ====="
===== TABLE A.5 PANEL A: WITHIN FIRM OLS (FIRM FE) =====

. 
. estimates clear

. 
. * Column 1: Firm FE only (no year, no occ)
. di "Loading Panel A Column 1 from tablea5a_col1.ster"
Loading Panel A Column 1 from tablea5a_col1.ster

. est use $sters/tablea5a_col1.ster

. qui est replay

. est sto tabJ1

. local Year "N"

. local Occ "N"

. local Firm "Y"

. estadd local Firm "`Firm'"

added macro:
               e(Firm) : "Y"

. estadd local Year "`Year'"

added macro:
               e(Year) : "N"

. estadd local Occ "`Occ'"

added macro:
                e(Occ) : "N"

. 
. * Column 2: Firm FE + Year
. di "Loading Panel A Column 2 from tablea5a_col2.ster"
Loading Panel A Column 2 from tablea5a_col2.ster

. est use $sters/tablea5a_col2.ster

. qui est replay

. est sto tabJ2

. local Year "Y"

. local Occ "N"

. local Firm "Y"

. estadd local Firm "`Firm'"

added macro:
               e(Firm) : "Y"

. estadd local Year "`Year'"

added macro:
               e(Year) : "Y"

. estadd local Occ "`Occ'"

added macro:
                e(Occ) : "N"

. 
. * Column 3: Firm FE + Occ
. di "Loading Panel A Column 3 from tablea5a_col3.ster"
Loading Panel A Column 3 from tablea5a_col3.ster

. est use $sters/tablea5a_col3.ster

. qui est replay

. est sto tabJ3

. local Year "N"

. local Occ "Y"

. local Firm "Y"

. estadd local Firm "`Firm'"

added macro:
               e(Firm) : "Y"

. estadd local Year "`Year'"

added macro:
               e(Year) : "N"

. estadd local Occ "`Occ'"

added macro:
                e(Occ) : "Y"

. 
. * Column 4: Firm FE + Year + Occ
. di "Loading Panel A Column 4 from tablea5a_col4.ster"
Loading Panel A Column 4 from tablea5a_col4.ster

. est use $sters/tablea5a_col4.ster

. qui est replay

. est sto tabJ4

. local Year "Y"

. local Occ "Y"

. local Firm "Y"

. estadd local Firm "`Firm'"

added macro:
               e(Firm) : "Y"

. estadd local Year "`Year'"

added macro:
               e(Year) : "Y"

. estadd local Occ "`Occ'"

added macro:
                e(Occ) : "Y"

. 
. * Output formatting for Panel A
. local title "Firm, Occupation Level: Within Firm OLS: DV: Log(1+1000*(Back Wa
> ges/Promised Wages))"

. local rename "rename(hhithreeyearavg HHI logh1bs log(H1Bs))"

. local keeps "HHI log(H1Bs)"

. local stuff "numbers label cells(b(fmt(a3) star) se(fmt(a3) par)) starlevels(
> * 0.1 ** 0.05 *** 0.01)"

. local prehead "prehead(\begin{table}\centering \caption{`title'}\centering\me
> dskip \begin{tabular}{lccccc} \hline \hline) mlabels(none)"

. local postfoot "postfoot(\hline \hline \end{tabular} \end{table})"

. local addons "`prehead' style(tex) `stuff' substitute(r2 R-Squared _ \_) `pos
> tfoot'"

. 
. estout tabJ* using $tables/table_a5_panelA.tex, replace `rename' keep(`keeps'
> ) order(`keeps') `addons' ///
>   prefoot(\hline) stats(Year Occ Firm r2 k_absorb N, fmt(%9.2gc %9.2f %9.0fc 
> %9.0fc))
(output written to ./output/tables/table_a5_panelA.tex)

. 
. di "Table A.5 Panel A saved to: $tables/table_a5_panelA.tex"
Table A.5 Panel A saved to: ./output/tables/table_a5_panelA.tex

. 
. *----------------------------------------------------------------------------
> ---
. * PANEL B: Between Firm Ordinary Least Squares (Pooled OLS with CZ clustering
> )
. * Uses analytical weights [aw=nbr_h1bs] with CZ FE
. * Files: tablea5b_col1.ster through tablea5b_col4.ster
. *----------------------------------------------------------------------------
> ---
. 
. di "===== TABLE A.5 PANEL B: BETWEEN FIRM OLS ====="
===== TABLE A.5 PANEL B: BETWEEN FIRM OLS =====

. 
. estimates clear

. 
. * Column 1: CZ FE only (no year, no occ)
. di "Loading Panel B Column 1 from tablea5b_col1.ster"
Loading Panel B Column 1 from tablea5b_col1.ster

. est use $sters/tablea5b_col1.ster

. qui est replay

. est sto tabK1

. local Year "N"

. local Occ "N"

. local CZ "Y"

. estadd local CZ "`CZ'"

added macro:
                 e(CZ) : "Y"

. estadd local Year "`Year'"

added macro:
               e(Year) : "N"

. estadd local Occ "`Occ'"

added macro:
                e(Occ) : "N"

. 
. * Column 2: CZ FE + Year
. di "Loading Panel B Column 2 from tablea5b_col2.ster"
Loading Panel B Column 2 from tablea5b_col2.ster

. est use $sters/tablea5b_col2.ster

. qui est replay

. est sto tabK2

. local Year "Y"

. local Occ "N"

. local CZ "Y"

. estadd local CZ "`CZ'"

added macro:
                 e(CZ) : "Y"

. estadd local Year "`Year'"

added macro:
               e(Year) : "Y"

. estadd local Occ "`Occ'"

added macro:
                e(Occ) : "N"

. 
. * Column 3: CZ FE + Occ
. di "Loading Panel B Column 3 from tablea5b_col3.ster"
Loading Panel B Column 3 from tablea5b_col3.ster

. est use $sters/tablea5b_col3.ster

. qui est replay

. est sto tabK3

. local Year "N"

. local Occ "Y"

. local CZ "Y"

. estadd local CZ "`CZ'"

added macro:
                 e(CZ) : "Y"

. estadd local Year "`Year'"

added macro:
               e(Year) : "N"

. estadd local Occ "`Occ'"

added macro:
                e(Occ) : "Y"

. 
. * Column 4: CZ FE + Year + Occ
. di "Loading Panel B Column 4 from tablea5b_col4.ster"
Loading Panel B Column 4 from tablea5b_col4.ster

. est use $sters/tablea5b_col4.ster

. qui est replay

. est sto tabK4

. local Year "Y"

. local Occ "Y"

. local CZ "Y"

. estadd local CZ "`CZ'"

added macro:
                 e(CZ) : "Y"

. estadd local Year "`Year'"

added macro:
               e(Year) : "Y"

. estadd local Occ "`Occ'"

added macro:
                e(Occ) : "Y"

. 
. * Output formatting for Panel B - must rebuild prehead and addons with new ti
> tle
. local title "Firm, Occupation Level: Between Firm OLS: DV: Log(1+1000*(Back W
> ages/Promised Wages))"

. local prehead "prehead(\begin{table}\centering \caption{`title'}\centering\me
> dskip \begin{tabular}{lccccc} \hline \hline) mlabels(none)"

. local addons "`prehead' style(tex) `stuff' substitute(r2 R-Squared _ \_) `pos
> tfoot'"

. 
. estout tabK* using $tables/table_a5_panelB.tex, replace `rename' keep(`keeps'
> ) order(`keeps') `addons' ///
>   prefoot(\hline) stats(Year Occ CZ N, fmt(%9.2gc %9.0fc) label("Year" "Occ" 
> "Commuting Zone" "N"))
(output written to ./output/tables/table_a5_panelB.tex)

. 
. di "Table A.5 Panel B saved to: $tables/table_a5_panelB.tex"
Table A.5 Panel B saved to: ./output/tables/table_a5_panelB.tex

. 
. *----------------------------------------------------------------------------
> ---
. * TABLE A.6: CELL-LEVEL OLS WITH HHI×SUBCONTRACTOR - LOG(BACK WAGES/PROMISED 
> WAGES)
. * Source: dos/run_regs.do (generates foiareg_3_logbwpw_*_hhix.ster files)
. * Original tex: foialogbwpw_reg_hhix_catset3.tex
. * Verified: All 8 columns match paper Appendix Table 6
. *
. * HHI coefficients:
. *   Col 1: -0.00562*** (No FE)
. *   Col 2: 0.0000605   (Year)
. *   Col 3: -0.00541*** (Occ)
. *   Col 4: -0.00249**  (CZ)
. *   Col 5: -0.00446*** (Occ+CZ)
. *   Col 6: 0.000673    (Year+Occ)
. *   Col 7: 0.00689***  (Year+CZ)
. *   Col 8: 0.00487**   (Year+Occ+CZ)
. *
. * N = 1,351,786 (col 1,3) or 1,351,602 (cols with Year FE)
. *
. * STER files: tablea6_col1.ster through tablea6_col8.ster
. * (Original names: foiareg_3_logbwpw_1_hhix.ster through foiareg_3_logbwpw_8_
> hhix.ster)
. *----------------------------------------------------------------------------
> ---
. * COMMENTED-OUT CODE TO REPRODUCE FROM SCRATCH:
. *----------------------------------------------------------------------------
> ---
. 
. di "===== TABLE A.6: CELL-LEVEL OLS LOG(BACK WAGES/PROMISED WAGES) ====="
===== TABLE A.6: CELL-LEVEL OLS LOG(BACK WAGES/PROMISED WAGES) =====

. 
. estimates clear

. 
. * Load from pre-computed .ster files
. di "Loading Table A.6 from sters/"
Loading Table A.6 from sters/

. 
. * Column 1: No FE
. est use $sters/tablea6_col1.ster

. qui est replay

. est sto tabL1

. local Year "N"

. local Occ "N"

. local CommuteZone "N"

. estadd local Year "`Year'"

added macro:
               e(Year) : "N"

. estadd local Occ "`Occ'"

added macro:
                e(Occ) : "N"

. estadd local CommuteZone "`CommuteZone'"

added macro:
        e(CommuteZone) : "N"

. 
. * Column 2: Year only
. est use $sters/tablea6_col2.ster

. qui est replay

. est sto tabL2

. local Year "Y"

. local Occ "N"

. local CommuteZone "N"

. estadd local Year "`Year'"

added macro:
               e(Year) : "Y"

. estadd local Occ "`Occ'"

added macro:
                e(Occ) : "N"

. estadd local CommuteZone "`CommuteZone'"

added macro:
        e(CommuteZone) : "N"

. 
. * Column 3: Occ only
. est use $sters/tablea6_col3.ster

. qui est replay

. est sto tabL3

. local Year "N"

. local Occ "Y"

. local CommuteZone "N"

. estadd local Year "`Year'"

added macro:
               e(Year) : "N"

. estadd local Occ "`Occ'"

added macro:
                e(Occ) : "Y"

. estadd local CommuteZone "`CommuteZone'"

added macro:
        e(CommuteZone) : "N"

. 
. * Column 4: CZ only
. est use $sters/tablea6_col4.ster

. qui est replay

. est sto tabL4

. local Year "N"

. local Occ "N"

. local CommuteZone "Y"

. estadd local Year "`Year'"

added macro:
               e(Year) : "N"

. estadd local Occ "`Occ'"

added macro:
                e(Occ) : "N"

. estadd local CommuteZone "`CommuteZone'"

added macro:
        e(CommuteZone) : "Y"

. 
. * Column 5: Occ + CZ
. est use $sters/tablea6_col5.ster

. qui est replay

. est sto tabL5

. local Year "N"

. local Occ "Y"

. local CommuteZone "Y"

. estadd local Year "`Year'"

added macro:
               e(Year) : "N"

. estadd local Occ "`Occ'"

added macro:
                e(Occ) : "Y"

. estadd local CommuteZone "`CommuteZone'"

added macro:
        e(CommuteZone) : "Y"

. 
. * Column 6: Year + Occ
. est use $sters/tablea6_col6.ster

. qui est replay

. est sto tabL6

. local Year "Y"

. local Occ "Y"

. local CommuteZone "N"

. estadd local Year "`Year'"

added macro:
               e(Year) : "Y"

. estadd local Occ "`Occ'"

added macro:
                e(Occ) : "Y"

. estadd local CommuteZone "`CommuteZone'"

added macro:
        e(CommuteZone) : "N"

. 
. * Column 7: Year + CZ
. est use $sters/tablea6_col7.ster

. qui est replay

. est sto tabL7

. local Year "Y"

. local Occ "N"

. local CommuteZone "Y"

. estadd local Year "`Year'"

added macro:
               e(Year) : "Y"

. estadd local Occ "`Occ'"

added macro:
                e(Occ) : "N"

. estadd local CommuteZone "`CommuteZone'"

added macro:
        e(CommuteZone) : "Y"

. 
. * Column 8: Year + Occ + CZ
. est use $sters/tablea6_col8.ster

. qui est replay

. est sto tabL8

. local Year "Y"

. local Occ "Y"

. local CommuteZone "Y"

. estadd local Year "`Year'"

added macro:
               e(Year) : "Y"

. estadd local Occ "`Occ'"

added macro:
                e(Occ) : "Y"

. estadd local CommuteZone "`CommuteZone'"

added macro:
        e(CommuteZone) : "Y"

. 
. * Output formatting
. local title "OLS Regression: Firm-Level, Year, Commuting Zone, and Occupation
>  Defined Labor Market"

. local rename "rename(hhithreeyearavg HHI 1.subcontractor Subcontractor 1.subc
> ontractor#c.hhithreeyearavg SubcontractorXHHI logh1bs log(nbrh1bs))"

. local keeps "HHI Subcontractor SubcontractorXHHI log(nbrh1bs)"

. local stuff "numbers label cells(b(fmt(a3) star) se(fmt(a3) par)) starlevels(
> * 0.1 ** 0.05 *** 0.01)"

. local prehead "prehead(\begin{sidewaystable}\centering \caption{`title'}\cent
> ering\medskip \begin{threeparttable} \begin{tabular}{lcccccccc} \hline \hline
> ) mlabels(none)"

. local postfoot "postfoot(\hline \hline \end{tabular} \begin{tablenotes} \item
>   \end{tablenotes} \end{threeparttable} \end{sidewaystable})"

. local addons "`prehead' style(tex) `stuff' substitute(r2 R-Squared _ \_) `pos
> tfoot'"

. 
. estout tabL* using $tables/table_a6.tex, replace `rename' keep(`keeps') order
> (`keeps') `addons' ///
>   prefoot(\hline) stats(Year Occ CommuteZone r2 N, fmt(%9.2gc %9.2f %9.0fc))
(output written to ./output/tables/table_a6.tex)

. 
. di "Table A.6 saved to: $tables/table_a6.tex"
Table A.6 saved to: ./output/tables/table_a6.tex

. 
. *----------------------------------------------------------------------------
> ---
. * TABLE A.7: CELL-LEVEL OLS - LOG(VIOLATIONS) - OCCUPATION-CZ-YEAR LEVEL
. * Source: dos/table_fx.do (calls table_fx logviol 2 reg hhi)
. * Original tex: foialogviol_reg_hhi_catset2.tex
. * Verified: All 8 columns match paper Appendix Table 7
. *
. * HHI coefficients:
. *   Col 1: -0.760*** (No FE)
. *   Col 2: -0.712*** (Year)
. *   Col 3: -0.778*** (Occ)
. *   Col 4: -0.409*** (CZ)
. *   Col 5: -0.227*** (Occ+CZ)
. *   Col 6: -0.732*** (Year+Occ)
. *   Col 7: -0.332*** (Year+CZ)
. *   Col 8: -0.162**  (Year+Occ+CZ)
. *
. * N = 51,330
. *
. * STER files: tablea7_col1.ster through tablea7_col8.ster
. * (Original names: foiareg_2_logviol_1_hhi.ster through foiareg_2_logviol_8_h
> hi.ster)
. *----------------------------------------------------------------------------
> ---
. * COMMENTED-OUT CODE TO REPRODUCE FROM SCRATCH:
. * Note: Uses category_set==2 (Occupation-CZ-Year level, NOT Firm level)
. *----------------------------------------------------------------------------
> ---
. 
. di "===== TABLE A.7: CELL-LEVEL OLS LOG(VIOLATIONS) - OCC-CZ-YEAR LEVEL =====
> "
===== TABLE A.7: CELL-LEVEL OLS LOG(VIOLATIONS) - OCC-CZ-YEAR LEVEL =====

. 
. estimates clear

. 
. * Load from pre-computed .ster files
. di "Loading Table A.7 from sters/"
Loading Table A.7 from sters/

. 
. * Column 1: No FE
. est use $sters/tablea7_col1.ster

. qui est replay

. est sto tabM1

. local Year "N"

. local Occ "N"

. local CommuteZone "N"

. estadd local Year "`Year'"

added macro:
               e(Year) : "N"

. estadd local Occupation "`Occ'"

added macro:
         e(Occupation) : "N"

. estadd local CommutingZone "`CommuteZone'"

added macro:
      e(CommutingZone) : "N"

. 
. * Column 2: Year only
. est use $sters/tablea7_col2.ster

. qui est replay

. est sto tabM2

. local Year "Y"

. local Occ "N"

. local CommuteZone "N"

. estadd local Year "`Year'"

added macro:
               e(Year) : "Y"

. estadd local Occupation "`Occ'"

added macro:
         e(Occupation) : "N"

. estadd local CommutingZone "`CommuteZone'"

added macro:
      e(CommutingZone) : "N"

. 
. * Column 3: Occ only
. est use $sters/tablea7_col3.ster

. qui est replay

. est sto tabM3

. local Year "N"

. local Occ "Y"

. local CommuteZone "N"

. estadd local Year "`Year'"

added macro:
               e(Year) : "N"

. estadd local Occupation "`Occ'"

added macro:
         e(Occupation) : "Y"

. estadd local CommutingZone "`CommuteZone'"

added macro:
      e(CommutingZone) : "N"

. 
. * Column 4: CZ only
. est use $sters/tablea7_col4.ster

. qui est replay

. est sto tabM4

. local Year "N"

. local Occ "N"

. local CommuteZone "Y"

. estadd local Year "`Year'"

added macro:
               e(Year) : "N"

. estadd local Occupation "`Occ'"

added macro:
         e(Occupation) : "N"

. estadd local CommutingZone "`CommuteZone'"

added macro:
      e(CommutingZone) : "Y"

. 
. * Column 5: Occ + CZ
. est use $sters/tablea7_col5.ster

. qui est replay

. est sto tabM5

. local Year "N"

. local Occ "Y"

. local CommuteZone "Y"

. estadd local Year "`Year'"

added macro:
               e(Year) : "N"

. estadd local Occupation "`Occ'"

added macro:
         e(Occupation) : "Y"

. estadd local CommutingZone "`CommuteZone'"

added macro:
      e(CommutingZone) : "Y"

. 
. * Column 6: Year + Occ
. est use $sters/tablea7_col6.ster

. qui est replay

. est sto tabM6

. local Year "Y"

. local Occ "Y"

. local CommuteZone "N"

. estadd local Year "`Year'"

added macro:
               e(Year) : "Y"

. estadd local Occupation "`Occ'"

added macro:
         e(Occupation) : "Y"

. estadd local CommutingZone "`CommuteZone'"

added macro:
      e(CommutingZone) : "N"

. 
. * Column 7: Year + CZ
. est use $sters/tablea7_col7.ster

. qui est replay

. est sto tabM7

. local Year "Y"

. local Occ "N"

. local CommuteZone "Y"

. estadd local Year "`Year'"

added macro:
               e(Year) : "Y"

. estadd local Occupation "`Occ'"

added macro:
         e(Occupation) : "N"

. estadd local CommutingZone "`CommuteZone'"

added macro:
      e(CommutingZone) : "Y"

. 
. * Column 8: Year + Occ + CZ
. est use $sters/tablea7_col8.ster

. qui est replay

. est sto tabM8

. local Year "Y"

. local Occ "Y"

. local CommuteZone "Y"

. estadd local Year "`Year'"

added macro:
               e(Year) : "Y"

. estadd local Occupation "`Occ'"

added macro:
         e(Occupation) : "Y"

. estadd local CommutingZone "`CommuteZone'"

added macro:
      e(CommutingZone) : "Y"

. 
. * Output formatting
. local title "OLS Regression: Log(1+1000*(WHD Violations/H1Bs)): Firm-Level, Y
> ear, Commuting Zone, and Occupation Defined Labor Market"

. local rename "rename(hhithreeyearavg HHI logh1bs log(nbrh1bs))"

. local keeps "HHI log(nbrh1bs)"

. local stuff "numbers label cells(b(fmt(a3) star) se(fmt(a3) par)) starlevels(
> * 0.1 ** 0.05 *** 0.01)"

. local prehead "prehead(\begin{sidewaystable}\centering \caption{`title'}\cent
> ering\medskip \begin{threeparttable} \begin{tabular}{lcccccccc} \hline \hline
> ) mlabels(none)"

. local postfoot "postfoot(\hline \hline \end{tabular} \begin{tablenotes} \item
>   \end{tablenotes} \end{threeparttable} \end{sidewaystable})"

. local addons "`prehead' style(tex) `stuff' substitute(r2 R-Squared _ \_) `pos
> tfoot'"

. 
. estout tabM* using $tables/table_a7.tex, replace `rename' keep(`keeps') order
> (`keeps') `addons' ///
>   prefoot(\hline) stats(Year Occupation CommutingZone r2 N, fmt(%9.2gc %9.2f 
> %9.0fc))
(output written to ./output/tables/table_a7.tex)

. 
. di "Table A.7 saved to: $tables/table_a7.tex"
Table A.7 saved to: ./output/tables/table_a7.tex

. 
. *----------------------------------------------------------------------------
> ---
. * TABLE A.8: CELL-LEVEL OLS - LOG(VIOLATIONS) - INDUSTRY-CZ-YEAR LEVEL
. * Source: dos/table_fx.do (calls table_fx logviol 1 reg hhi)
. * Original tex: foialogviol_reg_hhi_catset1.tex
. * Verified: All 8 columns match paper Appendix Table 8
. *
. * HHI coefficients:
. *   Col 1: -0.108*** (No FE)
. *   Col 2: -0.0825** (Year)
. *   Col 3: -0.144*** (Industry)
. *   Col 4: 0.0160    (CZ)
. *   Col 5: 0.0436    (Industry+CZ)
. *   Col 6: -0.155*** (Year+Industry)
. *   Col 7: 0.0521    (Year+CZ)
. *   Col 8: 0.0153    (Year+Industry+CZ)
. *
. * N = 50,062
. *
. * STER files: tablea8_col1.ster through tablea8_col8.ster
. * (Original names: foiareg_1_logviol_1_hhi.ster through foiareg_1_logviol_8_h
> hi.ster)
. *----------------------------------------------------------------------------
> ---
. 
. di "===== TABLE A.8: CELL-LEVEL OLS LOG(VIOLATIONS) - INDUSTRY-CZ-YEAR LEVEL 
> ====="
===== TABLE A.8: CELL-LEVEL OLS LOG(VIOLATIONS) - INDUSTRY-CZ-YEAR LEVEL =====

. 
. estimates clear

. 
. * Load from pre-computed .ster files
. di "Loading Table A.8 from sters/"
Loading Table A.8 from sters/

. 
. * Column 1: No FE
. est use $sters/tablea8_col1.ster

. qui est replay

. est sto tabN1

. local Year "N"

. local Industry "N"

. local CommuteZone "N"

. estadd local Year "`Year'"

added macro:
               e(Year) : "N"

. estadd local Industry "`Industry'"

added macro:
           e(Industry) : "N"

. estadd local CommutingZone "`CommuteZone'"

added macro:
      e(CommutingZone) : "N"

. 
. * Column 2: Year only
. est use $sters/tablea8_col2.ster

. qui est replay

. est sto tabN2

. local Year "Y"

. local Industry "N"

. local CommuteZone "N"

. estadd local Year "`Year'"

added macro:
               e(Year) : "Y"

. estadd local Industry "`Industry'"

added macro:
           e(Industry) : "N"

. estadd local CommutingZone "`CommuteZone'"

added macro:
      e(CommutingZone) : "N"

. 
. * Column 3: Industry only
. est use $sters/tablea8_col3.ster

. qui est replay

. est sto tabN3

. local Year "N"

. local Industry "Y"

. local CommuteZone "N"

. estadd local Year "`Year'"

added macro:
               e(Year) : "N"

. estadd local Industry "`Industry'"

added macro:
           e(Industry) : "Y"

. estadd local CommutingZone "`CommuteZone'"

added macro:
      e(CommutingZone) : "N"

. 
. * Column 4: CZ only
. est use $sters/tablea8_col4.ster

. qui est replay

. est sto tabN4

. local Year "N"

. local Industry "N"

. local CommuteZone "Y"

. estadd local Year "`Year'"

added macro:
               e(Year) : "N"

. estadd local Industry "`Industry'"

added macro:
           e(Industry) : "N"

. estadd local CommutingZone "`CommuteZone'"

added macro:
      e(CommutingZone) : "Y"

. 
. * Column 5: Industry + CZ
. est use $sters/tablea8_col5.ster

. qui est replay

. est sto tabN5

. local Year "N"

. local Industry "Y"

. local CommuteZone "Y"

. estadd local Year "`Year'"

added macro:
               e(Year) : "N"

. estadd local Industry "`Industry'"

added macro:
           e(Industry) : "Y"

. estadd local CommutingZone "`CommuteZone'"

added macro:
      e(CommutingZone) : "Y"

. 
. * Column 6: Year + Industry
. est use $sters/tablea8_col6.ster

. qui est replay

. est sto tabN6

. local Year "Y"

. local Industry "Y"

. local CommuteZone "N"

. estadd local Year "`Year'"

added macro:
               e(Year) : "Y"

. estadd local Industry "`Industry'"

added macro:
           e(Industry) : "Y"

. estadd local CommutingZone "`CommuteZone'"

added macro:
      e(CommutingZone) : "N"

. 
. * Column 7: Year + CZ
. est use $sters/tablea8_col7.ster

. qui est replay

. est sto tabN7

. local Year "Y"

. local Industry "N"

. local CommuteZone "Y"

. estadd local Year "`Year'"

added macro:
               e(Year) : "Y"

. estadd local Industry "`Industry'"

added macro:
           e(Industry) : "N"

. estadd local CommutingZone "`CommuteZone'"

added macro:
      e(CommutingZone) : "Y"

. 
. * Column 8: Year + Industry + CZ
. est use $sters/tablea8_col8.ster

. qui est replay

. est sto tabN8

. local Year "Y"

. local Industry "Y"

. local CommuteZone "Y"

. estadd local Year "`Year'"

added macro:
               e(Year) : "Y"

. estadd local Industry "`Industry'"

added macro:
           e(Industry) : "Y"

. estadd local CommutingZone "`CommuteZone'"

added macro:
      e(CommutingZone) : "Y"

. 
. * Output formatting
. local title "OLS Regression: Log(1+1000*(WHD Violations/H1Bs)): Firm-Level, Y
> ear, Commuting Zone, and Industry Defined Labor Market"

. local rename "rename(hhithreeyearavg HHI logh1bs log(nbrh1bs))"

. local keeps "HHI log(nbrh1bs)"

. local stuff "numbers label cells(b(fmt(a3) star) se(fmt(a3) par)) starlevels(
> * 0.1 ** 0.05 *** 0.01)"

. local prehead "prehead(\begin{sidewaystable}\centering \caption{`title'}\cent
> ering\medskip \begin{threeparttable} \begin{tabular}{lcccccccc} \hline \hline
> ) mlabels(none)"

. local postfoot "postfoot(\hline \hline \end{tabular} \begin{tablenotes} \item
>   \end{tablenotes} \end{threeparttable} \end{sidewaystable})"

. local addons "`prehead' style(tex) `stuff' substitute(r2 R-Squared _ \_) `pos
> tfoot'"

. 
. estout tabN* using $tables/table_a8.tex, replace `rename' keep(`keeps') order
> (`keeps') `addons' ///
>   prefoot(\hline) stats(Year Industry CommutingZone r2 N, fmt(%9.2gc %9.2f %9
> .0fc))
(output written to ./output/tables/table_a8.tex)

. 
. di "Table A.8 saved to: $tables/table_a8.tex"
Table A.8 saved to: ./output/tables/table_a8.tex

. 
. 
. *----------------------------------------------------------------------------
> ---
. * TABLE A.9: UNWEIGHTED FIRM-LEVEL REGRESSIONS - LOG(VIOLATIONS)
. * Source: 01a_run_regressions.do (pre-computed .ster files)
. *
. * Panel A: Within Firm Ordinary Least Squares (Firm Fixed Effects) - UNWEIGHT
> ED
. * Panel B: Between Firm Ordinary Least Squares - UNWEIGHTED
. *
. * Paper shows:
. *   Panel A (Firm FE) HHI coefficients: -0.0233** -0.0131** -0.0227** -0.0129
> *
. *   Panel B (RE) HHI coefficients: -0.0187*** -0.0122** -0.0197*** -0.0120**
. *   N = 1,237,741 (Panel A), 1,237,750 (Panel B)
. *
. * STER files: tablea9a_col1-4.ster (Panel A), tablea9b_col1-4.ster (Panel B)
. *----------------------------------------------------------------------------
> ---
. 
. di "===== TABLE A.9: LOADING FROM PRE-COMPUTED .STER FILES ====="
===== TABLE A.9: LOADING FROM PRE-COMPUTED .STER FILES =====

. 
. *--- Panel A: Within Firm OLS (Firm Fixed Effects) - UNWEIGHTED ---
. 
. di "===== TABLE A.9 PANEL A: WITHIN FIRM OLS (UNWEIGHTED) ====="
===== TABLE A.9 PANEL A: WITHIN FIRM OLS (UNWEIGHTED) =====

. 
. estimates clear

. 
. * Load from pre-computed .ster files
. est use $sters/tablea9a_col1.ster

. qui est replay

. est sto tabO1

. estadd local Year "N"

added macro:
               e(Year) : "N"

. estadd local Occ "N"

added macro:
                e(Occ) : "N"

. estadd local Firm "Y"

added macro:
               e(Firm) : "Y"

. 
. est use $sters/tablea9a_col2.ster

. qui est replay

. est sto tabO2

. estadd local Year "Y"

added macro:
               e(Year) : "Y"

. estadd local Occ "N"

added macro:
                e(Occ) : "N"

. estadd local Firm "Y"

added macro:
               e(Firm) : "Y"

. 
. est use $sters/tablea9a_col3.ster

. qui est replay

. est sto tabO3

. estadd local Year "N"

added macro:
               e(Year) : "N"

. estadd local Occ "Y"

added macro:
                e(Occ) : "Y"

. estadd local Firm "Y"

added macro:
               e(Firm) : "Y"

. 
. est use $sters/tablea9a_col4.ster

. qui est replay

. est sto tabO4

. estadd local Year "Y"

added macro:
               e(Year) : "Y"

. estadd local Occ "Y"

added macro:
                e(Occ) : "Y"

. estadd local Firm "Y"

added macro:
               e(Firm) : "Y"

. 
. local title "Firm, Occupation Level: Within Firm OLS (Unweighted): DV: Log(1+
>  1000*(Violations/H1Bs))"

. local rename "rename(hhithreeyearavg HHI logh1bs log(H1Bs))"

. local keeps "HHI log(H1Bs)"

. local stuff "numbers label cells(b(fmt(a3) star) se(fmt(a3) par)) starlevels(
> * 0.1 ** 0.05 *** 0.01)"

. local prehead "prehead(\begin{table}\centering \caption{`title'}\centering\me
> dskip \begin{tabular}{lccccc} \hline \hline) mlabels(none)"

. local postfoot "postfoot(\hline \hline \end{tabular} \end{table})"

. local addons "`prehead' style(tex) `stuff' substitute(r2 R-Squared _ \_) `pos
> tfoot'"

. 
. estout tabO* using $tables/table_a9_panelA.tex, replace `rename' keep(`keeps'
> ) order(`keeps') `addons' ///
>   prefoot(\hline) stats(Year Occ Firm r2 k_absorb N, fmt(%9.2gc %9.2f %9.0fc 
> %9.0fc))
(output written to ./output/tables/table_a9_panelA.tex)

. 
. di "Table A.9 Panel A saved to: $tables/table_a9_panelA.tex"
Table A.9 Panel A saved to: ./output/tables/table_a9_panelA.tex

. 
. *--- Panel B: Between Firm OLS - UNWEIGHTED ---
. 
. di "===== TABLE A.9 PANEL B: BETWEEN FIRM OLS (UNWEIGHTED) ====="
===== TABLE A.9 PANEL B: BETWEEN FIRM OLS (UNWEIGHTED) =====

. 
. estimates clear

. 
. * Load from pre-computed .ster files
. est use $sters/tablea9b_col1.ster

. qui est replay

. est sto tabP1

. estadd local Year "N"

added macro:
               e(Year) : "N"

. estadd local Occ "N"

added macro:
                e(Occ) : "N"

. estadd local CZ "Y"

added macro:
                 e(CZ) : "Y"

. 
. est use $sters/tablea9b_col2.ster

. qui est replay

. est sto tabP2

. estadd local Year "Y"

added macro:
               e(Year) : "Y"

. estadd local Occ "N"

added macro:
                e(Occ) : "N"

. estadd local CZ "Y"

added macro:
                 e(CZ) : "Y"

. 
. est use $sters/tablea9b_col3.ster

. qui est replay

. est sto tabP3

. estadd local Year "N"

added macro:
               e(Year) : "N"

. estadd local Occ "Y"

added macro:
                e(Occ) : "Y"

. estadd local CZ "Y"

added macro:
                 e(CZ) : "Y"

. 
. est use $sters/tablea9b_col4.ster

. qui est replay

. est sto tabP4

. estadd local Year "Y"

added macro:
               e(Year) : "Y"

. estadd local Occ "Y"

added macro:
                e(Occ) : "Y"

. estadd local CZ "Y"

added macro:
                 e(CZ) : "Y"

. 
. local title "Firm, Occupation Level: Between Firm OLS (Unweighted): DV: Log(1
> + 1000*(Violations/H1Bs))"

. local prehead "prehead(\begin{table}\centering \caption{`title'}\centering\me
> dskip \begin{tabular}{lccccc} \hline \hline) mlabels(none)"

. local addons "`prehead' style(tex) `stuff' substitute(r2 R-Squared _ \_) `pos
> tfoot'"

. 
. estout tabP* using $tables/table_a9_panelB.tex, replace `rename' keep(`keeps'
> ) order(`keeps') `addons' ///
>   prefoot(\hline) stats(Year Occ CZ r2 N, fmt(%9.2gc %9.2f %9.2fc %9.0fc) lab
> el("Year" "Occ" "Commuting Zone" "R-Squared" "N"))
(output written to ./output/tables/table_a9_panelB.tex)

. 
. di "Table A.9 Panel B saved to: $tables/table_a9_panelB.tex"
Table A.9 Panel B saved to: ./output/tables/table_a9_panelB.tex

. 
. *----------------------------------------------------------------------------
> ---
. * TABLE A.10: CELL-LEVEL OLS WITH HHI×SUBCONTRACTOR - LOG(VIOLATIONS)
. * Source: dos/run_regs.do
. * Original tex: foialogviol_reg_hhix_catset3.tex
. * Verified: All 8 columns match paper Appendix Table 10
. *
. * HHI coefficients:
. *   Col 1: -0.0102*** (No FE)
. *   Col 2: -0.00284   (Year)
. *   Col 3: -0.0108*** (Occ)
. *   Col 4: -0.00664***(CZ)
. *   Col 5: -0.0126*** (Occ+CZ)
. *   Col 6: -0.00261   (Year+Occ)
. *   Col 7: 0.00721*   (Year+CZ)
. *   Col 8: 0.00164    (Year+Occ+CZ)
. *
. * N = 1,237,779
. *
. * STER files: tablea10_col1.ster through tablea10_col8.ster
. *----------------------------------------------------------------------------
> ---
. 
. di "===== TABLE A.10: CELL-LEVEL OLS LOG(VIOLATIONS) WITH HHI×SUB ====="
===== TABLE A.10: CELL-LEVEL OLS LOG(VIOLATIONS) WITH HHI×SUB =====

. 
. estimates clear

. 
. * Load from pre-computed .ster files
. di "Loading Table A.10 from sters/"
Loading Table A.10 from sters/

. 
. forvalues i = 1/8 {
  2.     est use $sters/tablea10_col`i'.ster
  3.     qui est replay
  4.     est sto tabQ`i'
  5. 
.     if `i'==1 {
  6.         local Year "N"
  7.         local Occ "N"
  8.         local CommuteZone "N"
  9.     }
 10.     if `i'==2 {
 11.         local Year "Y"
 12.         local Occ "N"
 13.         local CommuteZone "N"
 14.     }
 15.     if `i'==3 {
 16.         local Year "N"
 17.         local Occ "Y"
 18.         local CommuteZone "N"
 19.     }
 20.     if `i'==4 {
 21.         local Year "N"
 22.         local Occ "N"
 23.         local CommuteZone "Y"
 24.     }
 25.     if `i'==5 {
 26.         local Year "N"
 27.         local Occ "Y"
 28.         local CommuteZone "Y"
 29.     }
 30.     if `i'==6 {
 31.         local Year "Y"
 32.         local Occ "Y"
 33.         local CommuteZone "N"
 34.     }
 35.     if `i'==7 {
 36.         local Year "Y"
 37.         local Occ "N"
 38.         local CommuteZone "Y"
 39.     }
 40.     if `i'==8 {
 41.         local Year "Y"
 42.         local Occ "Y"
 43.         local CommuteZone "Y"
 44.     }
 45. 
.     estadd local Year "`Year'"
 46.     estadd local Occupation "`Occ'"
 47.     estadd local CommutingZone "`CommuteZone'"
 48. }

added macro:
               e(Year) : "N"

added macro:
         e(Occupation) : "N"

added macro:
      e(CommutingZone) : "N"

added macro:
               e(Year) : "Y"

added macro:
         e(Occupation) : "N"

added macro:
      e(CommutingZone) : "N"

added macro:
               e(Year) : "N"

added macro:
         e(Occupation) : "Y"

added macro:
      e(CommutingZone) : "N"

added macro:
               e(Year) : "N"

added macro:
         e(Occupation) : "N"

added macro:
      e(CommutingZone) : "Y"

added macro:
               e(Year) : "N"

added macro:
         e(Occupation) : "Y"

added macro:
      e(CommutingZone) : "Y"

added macro:
               e(Year) : "Y"

added macro:
         e(Occupation) : "Y"

added macro:
      e(CommutingZone) : "N"

added macro:
               e(Year) : "Y"

added macro:
         e(Occupation) : "N"

added macro:
      e(CommutingZone) : "Y"

added macro:
               e(Year) : "Y"

added macro:
         e(Occupation) : "Y"

added macro:
      e(CommutingZone) : "Y"

. 
. local title "OLS Regression: Log(1+1000*(WHD Violations/H1Bs)): Firm-Level, Y
> ear, Commuting Zone, and Occupation Defined Labor Market"

. local rename "rename(hhithreeyearavg HHI 1.subcontractor Subcontractor 1.subc
> ontractor#c.hhithreeyearavg SubcontractorXHHI logh1bs log(nbrh1bs))"

. local keeps "HHI Subcontractor SubcontractorXHHI log(nbrh1bs)"

. local stuff "numbers label cells(b(fmt(a3) star) se(fmt(a3) par)) starlevels(
> * 0.1 ** 0.05 *** 0.01)"

. local prehead "prehead(\begin{sidewaystable}\centering \caption{`title'}\cent
> ering\medskip \begin{threeparttable} \begin{tabular}{lcccccccc} \hline \hline
> ) mlabels(none)"

. local postfoot "postfoot(\hline \hline \end{tabular} \begin{tablenotes} \item
>   \end{tablenotes} \end{threeparttable} \end{sidewaystable})"

. local addons "`prehead' style(tex) `stuff' substitute(r2 R-Squared _ \_) `pos
> tfoot'"

. 
. estout tabQ* using $tables/table_a10.tex, replace `rename' keep(`keeps') orde
> r(`keeps') `addons' ///
>   prefoot(\hline) stats(Year Occupation CommutingZone r2 N, fmt(%9.2gc %9.2f 
> %9.0fc))
(output written to ./output/tables/table_a10.tex)

. 
. di "Table A.10 saved to: $tables/table_a10.tex"
Table A.10 saved to: ./output/tables/table_a10.tex

. 
. 
. *----------------------------------------------------------------------------
> ---
. * TABLE A.11: UNWEIGHTED FIRM-LEVEL REGRESSIONS - LOG(BACK WAGES)
. * Source: 01a_run_regressions.do (pre-computed .ster files)
. *
. * Panel A: Within Firm Ordinary Least Squares (Firm Fixed Effects) - UNWEIGHT
> ED
. * Panel B: Between Firm Ordinary Least Squares (with CZ FE) - UNWEIGHTED
. *
. * Paper shows:
. *   Panel A (Firm FE) HHI coefficients: -0.0481** -0.0247* -0.0432** -0.0213
. *   Panel B (RE) HHI coefficients: -0.0386*** -0.0251*** -0.0384*** -0.0178*
. *   N = 1,237,741 (Panel A), 1,237,750 (Panel B)
. *
. * STER files: tablea11a_col1-4.ster (Panel A), tablea11b_col1-4.ster (Panel B
> )
. *----------------------------------------------------------------------------
> ---
. 
. di "===== TABLE A.11: LOADING FROM PRE-COMPUTED .STER FILES ====="
===== TABLE A.11: LOADING FROM PRE-COMPUTED .STER FILES =====

. 
. *--- Panel A: Within Firm OLS (Firm Fixed Effects) - UNWEIGHTED ---
. 
. di "===== TABLE A.11 PANEL A: WITHIN FIRM OLS (UNWEIGHTED) ====="
===== TABLE A.11 PANEL A: WITHIN FIRM OLS (UNWEIGHTED) =====

. 
. estimates clear

. 
. * Load from pre-computed .ster files
. est use $sters/tablea11a_col1.ster

. qui est replay

. est sto tabR1

. estadd local Year "N"

added macro:
               e(Year) : "N"

. estadd local Occ "N"

added macro:
                e(Occ) : "N"

. estadd local Firm "Y"

added macro:
               e(Firm) : "Y"

. 
. est use $sters/tablea11a_col2.ster

. qui est replay

. est sto tabR2

. estadd local Year "Y"

added macro:
               e(Year) : "Y"

. estadd local Occ "N"

added macro:
                e(Occ) : "N"

. estadd local Firm "Y"

added macro:
               e(Firm) : "Y"

. 
. est use $sters/tablea11a_col3.ster

. qui est replay

. est sto tabR3

. estadd local Year "N"

added macro:
               e(Year) : "N"

. estadd local Occ "Y"

added macro:
                e(Occ) : "Y"

. estadd local Firm "Y"

added macro:
               e(Firm) : "Y"

. 
. est use $sters/tablea11a_col4.ster

. qui est replay

. est sto tabR4

. estadd local Year "Y"

added macro:
               e(Year) : "Y"

. estadd local Occ "Y"

added macro:
                e(Occ) : "Y"

. estadd local Firm "Y"

added macro:
               e(Firm) : "Y"

. 
. local title "Firm, Occupation Level: Within Firm OLS (Unweighted): DV: Log(1+
> 1000*(Back Wages/H1Bs))"

. local rename "rename(hhithreeyearavg HHI logh1bs log(H1Bs))"

. local keeps "HHI log(H1Bs)"

. local stuff "numbers label cells(b(fmt(a3) star) se(fmt(a3) par)) starlevels(
> * 0.1 ** 0.05 *** 0.01)"

. local prehead "prehead(\begin{table}\centering \caption{`title'}\centering\me
> dskip \begin{tabular}{lccccc} \hline \hline) mlabels(none)"

. local postfoot "postfoot(\hline \hline \end{tabular} \end{table})"

. local addons "`prehead' style(tex) `stuff' substitute(r2 R-Squared _ \_) `pos
> tfoot'"

. 
. estout tabR* using $tables/table_a11_panelA.tex, replace `rename' keep(`keeps
> ') order(`keeps') `addons' ///
>   prefoot(\hline) stats(Year Occ Firm r2 k_absorb N, fmt(%9.2gc %9.2f %9.0fc 
> %9.0fc))
(output written to ./output/tables/table_a11_panelA.tex)

. 
. di "Table A.11 Panel A saved to: $tables/table_a11_panelA.tex"
Table A.11 Panel A saved to: ./output/tables/table_a11_panelA.tex

. 
. *--- Panel B: Between Firm OLS (CZ Fixed Effects) - UNWEIGHTED ---
. 
. di "===== TABLE A.11 PANEL B: BETWEEN FIRM OLS (UNWEIGHTED) ====="
===== TABLE A.11 PANEL B: BETWEEN FIRM OLS (UNWEIGHTED) =====

. 
. estimates clear

. 
. * Load from pre-computed .ster files
. est use $sters/tablea11b_col1.ster

. qui est replay

. est sto tabS1

. estadd local Year "N"

added macro:
               e(Year) : "N"

. estadd local Occ "N"

added macro:
                e(Occ) : "N"

. estadd local Firm "Y"

added macro:
               e(Firm) : "Y"

. 
. est use $sters/tablea11b_col2.ster

. qui est replay

. est sto tabS2

. estadd local Year "Y"

added macro:
               e(Year) : "Y"

. estadd local Occ "N"

added macro:
                e(Occ) : "N"

. estadd local Firm "Y"

added macro:
               e(Firm) : "Y"

. 
. est use $sters/tablea11b_col3.ster

. qui est replay

. est sto tabS3

. estadd local Year "N"

added macro:
               e(Year) : "N"

. estadd local Occ "Y"

added macro:
                e(Occ) : "Y"

. estadd local Firm "Y"

added macro:
               e(Firm) : "Y"

. 
. est use $sters/tablea11b_col4.ster

. qui est replay

. est sto tabS4

. estadd local Year "Y"

added macro:
               e(Year) : "Y"

. estadd local Occ "Y"

added macro:
                e(Occ) : "Y"

. estadd local Firm "Y"

added macro:
               e(Firm) : "Y"

. 
. local title "Firm, Occupation Level: Between Firm OLS (Unweighted): DV: Log(1
> +1000*(Back Wages/H1Bs))"

. local prehead "prehead(\begin{table}\centering \caption{`title'}\centering\me
> dskip \begin{tabular}{lccccc} \hline \hline) mlabels(none)"

. local addons "`prehead' style(tex) `stuff' substitute(r2 R-Squared _ \_) `pos
> tfoot'"

. 
. estout tabS* using $tables/table_a11_panelB.tex, replace `rename' keep(`keeps
> ') order(`keeps') `addons' ///
>   prefoot(\hline) stats(Year Occ CZ r2 N, fmt(%9.2gc %9.2f %9.2fc %9.0fc) lab
> el("Year" "Occ" "Commuting Zone" "R-Squared" "N"))
(output written to ./output/tables/table_a11_panelB.tex)

. 
. di "Table A.11 Panel B saved to: $tables/table_a11_panelB.tex"
Table A.11 Panel B saved to: ./output/tables/table_a11_panelB.tex

. 
. *----------------------------------------------------------------------------
> ---
. * TABLE A.12: CELL-LEVEL OLS WITH HHI×SUBCONTRACTOR - LOG(BACK WAGES)
. * Source: dos/run_regs.do
. * Original tex: foialogbw_reg_hhix_catset3.tex
. * Verified: All 8 columns match paper Appendix Table 12
. *
. * HHI coefficients:
. *   Col 1: -0.0271*** (No FE)
. *   Col 2: -0.0118**  (Year)
. *   Col 3: -0.0260*** (Occ)
. *   Col 4: -0.0192*** (CZ)
. *   Col 5: -0.0258*** (Occ+CZ)
. *   Col 6: -0.00963*  (Year+Occ)
. *   Col 7: 0.00943    (Year+CZ)
. *   Col 8: 0.00296    (Year+Occ+CZ)
. *
. * N = 1,237,779
. *
. * STER files: tablea12_col1.ster through tablea12_col8.ster
. *----------------------------------------------------------------------------
> ---
. 
. di "===== TABLE A.12: CELL-LEVEL OLS LOG(BACK WAGES) WITH HHI×SUB ====="
===== TABLE A.12: CELL-LEVEL OLS LOG(BACK WAGES) WITH HHI×SUB =====

. 
. estimates clear

. 
. * Load from pre-computed .ster files
. di "Loading Table A.12 from sters/"
Loading Table A.12 from sters/

. 
. forvalues i = 1/8 {
  2.     est use $sters/tablea12_col`i'.ster
  3.     qui est replay
  4.     est sto tabT`i'
  5. 
.     if `i'==1 {
  6.         local Year "N"
  7.         local Occ "N"
  8.         local CommuteZone "N"
  9.     }
 10.     if `i'==2 {
 11.         local Year "Y"
 12.         local Occ "N"
 13.         local CommuteZone "N"
 14.     }
 15.     if `i'==3 {
 16.         local Year "N"
 17.         local Occ "Y"
 18.         local CommuteZone "N"
 19.     }
 20.     if `i'==4 {
 21.         local Year "N"
 22.         local Occ "N"
 23.         local CommuteZone "Y"
 24.     }
 25.     if `i'==5 {
 26.         local Year "N"
 27.         local Occ "Y"
 28.         local CommuteZone "Y"
 29.     }
 30.     if `i'==6 {
 31.         local Year "Y"
 32.         local Occ "Y"
 33.         local CommuteZone "N"
 34.     }
 35.     if `i'==7 {
 36.         local Year "Y"
 37.         local Occ "N"
 38.         local CommuteZone "Y"
 39.     }
 40.     if `i'==8 {
 41.         local Year "Y"
 42.         local Occ "Y"
 43.         local CommuteZone "Y"
 44.     }
 45. 
.     estadd local Year "`Year'"
 46.     estadd local Occupation "`Occ'"
 47.     estadd local CommutingZone "`CommuteZone'"
 48. }

added macro:
               e(Year) : "N"

added macro:
         e(Occupation) : "N"

added macro:
      e(CommutingZone) : "N"

added macro:
               e(Year) : "Y"

added macro:
         e(Occupation) : "N"

added macro:
      e(CommutingZone) : "N"

added macro:
               e(Year) : "N"

added macro:
         e(Occupation) : "Y"

added macro:
      e(CommutingZone) : "N"

added macro:
               e(Year) : "N"

added macro:
         e(Occupation) : "N"

added macro:
      e(CommutingZone) : "Y"

added macro:
               e(Year) : "N"

added macro:
         e(Occupation) : "Y"

added macro:
      e(CommutingZone) : "Y"

added macro:
               e(Year) : "Y"

added macro:
         e(Occupation) : "Y"

added macro:
      e(CommutingZone) : "N"

added macro:
               e(Year) : "Y"

added macro:
         e(Occupation) : "N"

added macro:
      e(CommutingZone) : "Y"

added macro:
               e(Year) : "Y"

added macro:
         e(Occupation) : "Y"

added macro:
      e(CommutingZone) : "Y"

. 
. local title "OLS Regression: Log(1+1000*(Back Wages/H1Bs)): Firm-Level, Year,
>  Commuting Zone, and Occupation Defined Labor Market"

. local rename "rename(hhithreeyearavg HHI 1.subcontractor Subcontractor 1.subc
> ontractor#c.hhithreeyearavg SubcontractorXHHI logh1bs log(nbrh1bs))"

. local keeps "HHI Subcontractor SubcontractorXHHI log(nbrh1bs)"

. local stuff "numbers label cells(b(fmt(a3) star) se(fmt(a3) par)) starlevels(
> * 0.1 ** 0.05 *** 0.01)"

. local prehead "prehead(\begin{sidewaystable}\centering \caption{`title'}\cent
> ering\medskip \begin{threeparttable} \begin{tabular}{lcccccccc} \hline \hline
> ) mlabels(none)"

. local postfoot "postfoot(\hline \hline \end{tabular} \begin{tablenotes} \item
>   \end{tablenotes} \end{threeparttable} \end{sidewaystable})"

. local addons "`prehead' style(tex) `stuff' substitute(r2 R-Squared _ \_) `pos
> tfoot'"

. 
. estout tabT* using $tables/table_a12.tex, replace `rename' keep(`keeps') orde
> r(`keeps') `addons' ///
>   prefoot(\hline) stats(Year Occupation CommutingZone r2 N, fmt(%9.2gc %9.2f 
> %9.0fc))
(output written to ./output/tables/table_a12.tex)

. 
. di "Table A.12 saved to: $tables/table_a12.tex"
Table A.12 saved to: ./output/tables/table_a12.tex

. 
. 
. di ""


. di "===== ALL TABLES GENERATED ====="
===== ALL TABLES GENERATED =====

. di ""


. di "Tables generated:"
Tables generated:

. di "  - Table 1: table1.tex (VERIFY against paper)"
  - Table 1: table1.tex (VERIFY against paper)

. di "  - Table 2: table2.tex (Verified)"
  - Table 2: table2.tex (Verified)

. di "  - Table 3: table3.tex (Verified)"
  - Table 3: table3.tex (Verified)

. di "  - Table 5a: table5a.tex (Marginal Effects - Changes in Probability)"
  - Table 5a: table5a.tex (Marginal Effects - Changes in Probability)

. di "  - Table 5b: table5b_panelA.tex, table5b_panelB.tex (Probabilities at Cr
> itical Values)"
  - Table 5b: table5b_panelA.tex, table5b_panelB.tex (Probabilities at Critical
>  Values)

. di "  - Table A.1: table_a1.tex (Verified)"
  - Table A.1: table_a1.tex (Verified)

. di "  - Table A.2 Panel A: table_a2_panelA.tex (Verified)"
  - Table A.2 Panel A: table_a2_panelA.tex (Verified)

. di "  - Table A.2 Panel B: table_a2_panelB.tex (Verified)"
  - Table A.2 Panel B: table_a2_panelB.tex (Verified)

. di "  - Table A.3 Panel A: table_a3_panelA.tex (Verified)"
  - Table A.3 Panel A: table_a3_panelA.tex (Verified)

. di "  - Table A.3 Panel B: table_a3_panelB.tex (Verified)"
  - Table A.3 Panel B: table_a3_panelB.tex (Verified)

. di "  - Table A.4: table_a4.tex (Verified)"
  - Table A.4: table_a4.tex (Verified)

. di "  - Table A.5 Panel A: table_a5_panelA.tex (Verified)"
  - Table A.5 Panel A: table_a5_panelA.tex (Verified)

. di "  - Table A.5 Panel B: table_a5_panelB.tex (Verified)"
  - Table A.5 Panel B: table_a5_panelB.tex (Verified)

. di "  - Table A.6: table_a6.tex (Verified)"
  - Table A.6: table_a6.tex (Verified)

. di "  - Table A.7: table_a7.tex (Verified)"
  - Table A.7: table_a7.tex (Verified)

. di "  - Table A.8: table_a8.tex (Verified)"
  - Table A.8: table_a8.tex (Verified)

. di "  - Table A.9: table_a9_panelA.tex, table_a9_panelB.tex (Verified)"
  - Table A.9: table_a9_panelA.tex, table_a9_panelB.tex (Verified)

. di "  - Table A.10: table_a10.tex (Verified)"
  - Table A.10: table_a10.tex (Verified)

. di "  - Table A.11: table_a11_panelA.tex, table_a11_panelB.tex (Verified)"
  - Table A.11: table_a11_panelA.tex, table_a11_panelB.tex (Verified)

. di "  - Table A.12: table_a12.tex (Verified)"
  - Table A.12: table_a12.tex (Verified)

. di ""


. 
. * End of tables file
. 
end of do-file

. 
. *----------------------------------------------------------------------------
> ---
. * STEP 3: GENERATE FIGURES
. *----------------------------------------------------------------------------
> ---
. di "=============================================="
==============================================

. di "STEP 3: Generating figures..."
STEP 3: Generating figures...

. di "=============================================="
==============================================

. di ""


. do "$code/02_figures.do"

. *============================================================================
> ===
. * 02_figures.do
. * Generates Figures 1, 2 (Panels A & B), 3, 4, and 5
. *
. * Data files required:
. *   - master_db.dta (comprehensive dataset with all merged data)
. *   - h1b_2019_match_clients.dta (for Figure 1 - NOT included due to size, 3.
> 1 GB)
. *
. * NOTE: Before running, run prepare_replication_data.do in the parent directo
> ry
. *       to create the comprehensive master_db.dta with:
. *       - Prevailing wage data (for Figure 2 Panel A & B)
. *       - Wage level data (for Figure 4)
. *       - All derived variables
. *
. * Figures generated:
. *   - Figure 1: Network Graph of Silicon Valley Outsourcing (PRE-GENERATED)
. *   - Figure 2 Panel A: Kernel Density of Wage Premium
. *   - Figure 2 Panel B: Probability of Violation as Function of Wage Premium
. *   - Figure 3: HHI Bar Chart by Violation Category
. *   - Figure 4: Violations Intensity by HHI, Subcontractor, and Skill Level
. *   - Figure 5: Probability a Firm Has a Violation (4-panel)
. *============================================================================
> ===
. 
. di "===== GENERATING FIGURES ====="
===== GENERATING FIGURES =====

. di ""


. 
. *----------------------------------------------------------------------------
> ---
. * FIGURE 1: NETWORK GRAPH
. * Source: dos/Network analysis.do lines 154-208
. * Verified: Visual match to paper
. *
. * NOTE: The source data file (h1b_2019_match_clients.dta) is 3.1 GB and not
. * included in the replication package. The pre-generated figure is provided.
. *----------------------------------------------------------------------------
> ---
. 
. di "===== FIGURE 1: NETWORK GRAPH ====="
===== FIGURE 1: NETWORK GRAPH =====

. di "Pre-generated figure: $figures/fig1_network.pdf"
Pre-generated figure: ./output/figures/fig1_network.pdf

. di "NOTE: Source data (3.1 GB) not included. Figure pre-generated."
NOTE: Source data (3.1 GB) not included. Figure pre-generated.

. di ""


. 
. /* Code for Figure 1 (requires h1b_2019_match_clients.dta - not included):
> 
> use "[path_to]/h1b_2019_match_clients.dta", clear
> 
> keep if case_status=="CERTIFIED"
> destring total_worker_positions, replace
> 
> * Clean client names for key firms
> foreach var in "GOOGLE" "CSTDELOITTE" "IITHCL" "IITTECHMAHINDRA" "IITINFOSYS"
>  "IITWIPRO" "IITCOGNIZANT" "INTEL" "IITLARSEN" "INTUIT" "IITTATA" "APPLE" "AD
> OBESYS" {
>   replace client_name="" if(name=="`var'" & client_name=="`var'")
> }
> 
> collapse (rawsum) total_worker_positions nbr_immigrants, by(name client_name)
> 
> * Define Silicon Valley firms
> gen silicon=0
> replace silicon=1 if inlist(name, "GOOGLE", "CSTDELOITTE", "IITHCL", "IITTECH
> MAHINDRA")
> replace silicon=1 if inlist(name, "IITINFOSYS", "IITWIPRO", "IITCOGNIZANT", "
> INTEL", "IITLARSEN", "INTUIT", "IITTATA", "APPLE", "ADOBESYS")
> 
> gen clients=0
> replace clients=1 if inlist(client_name, "GOOGLE", "CSTDELOITTE", "IITHCL", "
> IITTECHMAHINDRA", "")
> replace clients=1 if inlist(client_name, "IITINFOSYS", "IITWIPRO", "IITCOGNIZ
> ANT", "INTEL", "IITLARSEN", "INTUIT", "IITTATA", "APPLE", "ADOBESYS")
> 
> keep if silicon==1 & clients==1
> 
> * Create network (requires nwcommands package)
> nwfromedge client_name name nbr_immigrants
> 
> * Define node attributes
> gen color="Lead Firms"
> replace color="Subcontractors" if inlist(_nodelab, "CSTDELOITTE", "IITHCL", "
> IITTECHMAHINDRA", "IITINFOSYS", "IITWIPRO", "IITCOGNIZANT", "IITLARSEN", "IIT
> TATA")
> 
> gen h1bsize=0
> replace h1bsize=28850 if _nodelab=="GOOGLE"
> replace h1bsize=47983 if _nodelab=="CSTDELOITTE"
> replace h1bsize=31749 if _nodelab=="IITHCL"
> replace h1bsize=22619 if _nodelab=="IITTECHMAHINDRA"
> replace h1bsize=114568 if _nodelab=="IITINFOSYS"
> replace h1bsize=65732 if _nodelab=="IITWIPRO"
> replace h1bsize=170144 if _nodelab=="IITCOGNIZANT"
> replace h1bsize=23012 if _nodelab=="INTEL"
> replace h1bsize=24143 if _nodelab=="IITLARSEN"
> replace h1bsize=3520 if _nodelab=="INTUIT"
> replace h1bsize=88785 if _nodelab=="IITTATA"
> replace h1bsize=20350 if _nodelab=="APPLE"
> replace h1bsize=2487 if _nodelab=="ADOBESYS"
> 
> gen violator=0
> replace violator=1 if inlist(_nodelab, "IITHCL", "IITTECHMAHINDRA", "IITINFOS
> YS", "IITWIPRO", "IITCOGNIZANT", "IITLARSEN", "APPLE")
> 
> * Clean labels
> replace _nodelab="HCL" if _nodelab=="IITHCL"
> replace _nodelab="TATA" if _nodelab=="IITTATA"
> replace _nodelab="WIPRO" if _nodelab=="IITWIPRO"
> replace _nodelab="INFOSYS" if _nodelab=="IITINFOSYS"
> replace _nodelab="COGNIZANT" if _nodelab=="IITCOGNIZANT"
> replace _nodelab="LARSEN & TOUBRO" if _nodelab=="IITLARSEN"
> replace _nodelab="TECH MAHINDRA" if _nodelab=="IITTECHMAHINDRA"
> replace _nodelab="DELOITTE" if _nodelab=="CSTDELOITTE"
> replace _nodelab="ADOBE" if _nodelab=="ADOBESYS"
> 
> * Plot network
> nwplot network, label(_nodelab) layout(mds) scheme(s2mono) size(h1bsize) node
> factor(5) ///
>   symbol(color, symbolpalette(O D)) color(violator, colorpalette(green%20 red
> %20)) ///
>   edgecolorpalette(gray%10) legendopt(off) labelopt(mlabsize(medium) mlabcolo
> r(black))
> 
> graph export "$figures/fig1_network.pdf", replace
> 
> */
. 
. *----------------------------------------------------------------------------
> ---
. * FIGURE 2 PANEL A: KERNEL DENSITY OF WAGE PREMIUM
. * Source: insheet_aug_25.do lines 195-237
. * Verified: Visual match to paper
. *
. * This figure shows the kernel density of wage premium (wage - prevailing wag
> e)
. * by subcontractor status. Uses the adjusted wage premium (diff_adj) which
. * applies the $60k floor for subcontractors.
. *
. * REQUIRES: diff_adj variable (created by prepare_replication_data.do)
. *----------------------------------------------------------------------------
> ---
. 
. di "===== FIGURE 2 PANEL A: KERNEL DENSITY OF WAGE PREMIUM ====="
===== FIGURE 2 PANEL A: KERNEL DENSITY OF WAGE PREMIUM =====

. 
. use "$data/master_db.dta", clear

. 
. * Restrict to observations with wage premium data and years after 2005
. drop if diff_adj == .
(113,347 observations deleted)

. keep if year > 2005
(401,317 observations deleted)

. di "Observations with wage premium data (post-2005): " _N
Observations with wage premium data (post-2005): 951700

. 
. * Figure 2 Panel A: Kernel density with $60k floor adjustment for subcontract
> ors
. kdensity diff_adj [aw=nbr_h1bs] if subcontractor==0 & inrange(diff_adj, -1000
> 0, 35000), ///
>     addplot(kdensity diff_adj [aw=nbr_h1bs] if subcontractor==1 & inrange(dif
> f_adj, -10000, 35000)) ///
>     saving("$figures/fig2a_kdensity.gph", replace) ///
>     legend(ring(0) pos(2) label(1 "Lead Firms") label(2 "Subcontractors")) //
> /
>     bwidth(5000) title("") xtitle("Wage Premium over Prevailing Wage") ///
>     xlabel(-10000 "-10k" 0 "0" 10000 "10k" 20000 "20k" 30000 "30k") ///
>     xline(0) xscale(r(-10000 35000)) note("")
file ./output/figures/fig2a_kdensity.gph saved

. 
. graph export "$figures/fig2a_kdensity.pdf", replace
file ./output/figures/fig2a_kdensity.pdf saved as PDF format

. 
. di "Figure 2 Panel A saved to: $figures/fig2a_kdensity.pdf"
Figure 2 Panel A saved to: ./output/figures/fig2a_kdensity.pdf

. di ""


. 
. *----------------------------------------------------------------------------
> ---
. * FIGURE 2 PANEL B: PROBABILITY OF VIOLATION AS FUNCTION OF WAGE PREMIUM
. * Source: insheet_aug_25.do lines 213-224
. * Verified: Visual match to paper
. *
. * This figure shows Pr(Violation) on the y-axis against Wage Premium
. * (wage minus prevailing wage) on the x-axis, with separate lines for
. * Lead Firms vs Subcontractors.
. *
. * REQUIRES: diff_adj variable (created by running prepare_replication_data.do
. *           in the parent directory first)
. *----------------------------------------------------------------------------
> ---
. 
. di "===== FIGURE 2 PANEL B: PROBABILITY OF VIOLATION ====="
===== FIGURE 2 PANEL B: PROBABILITY OF VIOLATION =====

. 
. use "$data/master_db.dta", clear

. 
. * Use the adjusted wage premium (with $60k floor for subcontractors)
. * diff_adj = wage - prevailing_wage_1, or wage - 60000 if PW < 60000 for subs
. 
. * Restrict to observations with wage premium data
. drop if diff_adj == .
(113,347 observations deleted)

. di "Observations with wage premium data: " _N
Observations with wage premium data: 1353017

. 
. * Run probit with cubic polynomial in wage premium
. qui probit anyviol i.subcontractor c.diff_adj##c.diff_adj##c.diff_adj i.year 
> [pw=nbr_h1bs], vce(robust)

. 
. * Generate marginal predictions
. margins, at(diff_adj=(-10000(2500)45000) subcontractor=(0(1)1)) vsquish post 
> asobserved noestimcheck

Predictive margins                                   Number of obs = 1,238,730
Model VCE: Robust

Expression: Pr(anyviol), predict()
1._at:  subcontractor =      0
        diff_adj      = -10000
2._at:  subcontractor =      0
        diff_adj      =  -7500
3._at:  subcontractor =      0
        diff_adj      =  -5000
4._at:  subcontractor =      0
        diff_adj      =  -2500
5._at:  subcontractor =      0
        diff_adj      =      0
6._at:  subcontractor =      0
        diff_adj      =   2500
7._at:  subcontractor =      0
        diff_adj      =   5000
8._at:  subcontractor =      0
        diff_adj      =   7500
9._at:  subcontractor =      0
        diff_adj      =  10000
10._at: subcontractor =      0
        diff_adj      =  12500
11._at: subcontractor =      0
        diff_adj      =  15000
12._at: subcontractor =      0
        diff_adj      =  17500
13._at: subcontractor =      0
        diff_adj      =  20000
14._at: subcontractor =      0
        diff_adj      =  22500
15._at: subcontractor =      0
        diff_adj      =  25000
16._at: subcontractor =      0
        diff_adj      =  27500
17._at: subcontractor =      0
        diff_adj      =  30000
18._at: subcontractor =      0
        diff_adj      =  32500
19._at: subcontractor =      0
        diff_adj      =  35000
20._at: subcontractor =      0
        diff_adj      =  37500
21._at: subcontractor =      0
        diff_adj      =  40000
22._at: subcontractor =      0
        diff_adj      =  42500
23._at: subcontractor =      0
        diff_adj      =  45000
24._at: subcontractor =      1
        diff_adj      = -10000
25._at: subcontractor =      1
        diff_adj      =  -7500
26._at: subcontractor =      1
        diff_adj      =  -5000
27._at: subcontractor =      1
        diff_adj      =  -2500
28._at: subcontractor =      1
        diff_adj      =      0
29._at: subcontractor =      1
        diff_adj      =   2500
30._at: subcontractor =      1
        diff_adj      =   5000
31._at: subcontractor =      1
        diff_adj      =   7500
32._at: subcontractor =      1
        diff_adj      =  10000
33._at: subcontractor =      1
        diff_adj      =  12500
34._at: subcontractor =      1
        diff_adj      =  15000
35._at: subcontractor =      1
        diff_adj      =  17500
36._at: subcontractor =      1
        diff_adj      =  20000
37._at: subcontractor =      1
        diff_adj      =  22500
38._at: subcontractor =      1
        diff_adj      =  25000
39._at: subcontractor =      1
        diff_adj      =  27500
40._at: subcontractor =      1
        diff_adj      =  30000
41._at: subcontractor =      1
        diff_adj      =  32500
42._at: subcontractor =      1
        diff_adj      =  35000
43._at: subcontractor =      1
        diff_adj      =  37500
44._at: subcontractor =      1
        diff_adj      =  40000
45._at: subcontractor =      1
        diff_adj      =  42500
46._at: subcontractor =      1
        diff_adj      =  45000

------------------------------------------------------------------------------
             |            Delta-method
             |     Margin   std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
         _at |
          1  |   .0236669   .0011517    20.55   0.000     .0214095    .0259242
          2  |    .022332   .0010006    22.32   0.000     .0203709    .0242931
          3  |   .0209709   .0008678    24.16   0.000       .01927    .0226719
          4  |   .0196016   .0007521    26.06   0.000     .0181275    .0210757
          5  |   .0182403   .0006527    27.95   0.000     .0169611    .0195196
          6  |   .0169016   .0005696    29.67   0.000     .0157851     .018018
          7  |   .0155979   .0005034    30.98   0.000     .0146112    .0165846
          8  |   .0143398   .0004547    31.54   0.000     .0134486    .0152309
          9  |   .0131358   .0004233    31.03   0.000     .0123062    .0139654
         10  |   .0119926   .0004076    29.42   0.000     .0111937    .0127914
         11  |   .0109149   .0004046    26.98   0.000     .0101219     .011708
         12  |   .0099061   .0004104    24.14   0.000     .0091017    .0107105
         13  |   .0089676   .0004211    21.29   0.000     .0081422     .009793
         14  |   .0080999   .0004336    18.68   0.000       .00725    .0089498
         15  |   .0073021   .0004457    16.38   0.000     .0064285    .0081757
         16  |   .0065725   .0004559    14.42   0.000     .0056789    .0074661
         17  |   .0059085   .0004634    12.75   0.000     .0050002    .0068168
         18  |   .0053071   .0004679    11.34   0.000       .00439    .0062242
         19  |   .0047647   .0004693    10.15   0.000     .0038449    .0056845
         20  |   .0042776   .0004677     9.15   0.000     .0033608    .0051943
         21  |   .0038417   .0004636     8.29   0.000     .0029331    .0047503
         22  |   .0034531   .0004572     7.55   0.000      .002557    .0043492
         23  |   .0031078    .000449     6.92   0.000     .0022277    .0039879
         24  |   .0735802   .0026047    28.25   0.000      .068475    .0786853
         25  |   .0702326   .0023209    30.26   0.000     .0656838    .0747814
         26  |   .0667721    .002087    31.99   0.000     .0626818    .0708625
         27  |   .0632394   .0018984    33.31   0.000     .0595186    .0669603
         28  |   .0596727   .0017516    34.07   0.000     .0562397    .0631057
         29  |   .0561074   .0016435    34.14   0.000     .0528863    .0593285
         30  |   .0525759   .0015712    33.46   0.000     .0494963    .0556555
         31  |   .0491071   .0015315    32.07   0.000     .0461055    .0521087
         32  |   .0457265   .0015197    30.09   0.000     .0427479     .048705
         33  |   .0424556   .0015307    27.74   0.000     .0394556    .0454556
         34  |   .0393126   .0015584    25.23   0.000     .0362583     .042367
         35  |    .036312   .0015971    22.74   0.000     .0331817    .0394422
         36  |   .0334646   .0016414    20.39   0.000     .0302474    .0366818
         37  |   .0307783    .001687    18.24   0.000     .0274719    .0340848
         38  |   .0282578   .0017302    16.33   0.000     .0248666     .031649
         39  |   .0259052   .0017686    14.65   0.000     .0224389    .0293716
         40  |   .0237202   .0018002    13.18   0.000     .0201918    .0272485
         41  |   .0217002   .0018241    11.90   0.000      .018125    .0252754
         42  |   .0198412   .0018399    10.78   0.000     .0162351    .0234474
         43  |   .0181376   .0018476     9.82   0.000     .0145165    .0217588
         44  |   .0165828   .0018475     8.98   0.000     .0129618    .0202038
         45  |   .0151693   .0018404     8.24   0.000     .0115622    .0187764
         46  |   .0138891   .0018272     7.60   0.000     .0103079    .0174703
------------------------------------------------------------------------------

. 
. * Plot
. marginsplot, ///
>     xlabel(-10000 "-10k" 0 "0" 10000 "10k" 20000 "20k" 30000 "30k" 40000 "40k
> ") ///
>     legend(pos(6) col(2) order(4 "Subcontractor" 3 "Lead Firm")) ///
>     plot1opts(lpattern(".")) plot2opts(lpattern("l")) ///
>     xtitle("Wage Premium over Prevailing Wage") ///
>     ytitle("Pr(Violation)") ///
>     title("") ///
>     saving("$figures/fig2b_prob_viol.gph", replace)

Variables that uniquely identify margins: diff_adj subcontractor
file ./output/figures/fig2b_prob_viol.gph saved

. 
. graph export "$figures/fig2b_prob_viol.pdf", replace
file ./output/figures/fig2b_prob_viol.pdf saved as PDF format

. 
. di "Figure 2 Panel B saved to: $figures/fig2b_prob_viol.pdf"
Figure 2 Panel B saved to: ./output/figures/fig2b_prob_viol.pdf

. di ""


. 
. *----------------------------------------------------------------------------
> ---
. * FIGURE 3: HHI BAR CHART BY VIOLATION CATEGORY
. * Source: dos/descriptives.do lines 117-143
. * Verified: Visual match to paper
. *----------------------------------------------------------------------------
> ---
. 
. di "===== FIGURE 3: HHI BAR CHART ====="
===== FIGURE 3: HHI BAR CHART =====

. 
. use "$data/master_db.dta", clear

. keep if category_set==3
(113,347 observations deleted)

. 
. * Create violation categories
. gen violcat=0

. replace violcat=3 if viol==0
(1,347,369 real changes made)

. replace violcat=2 if viol>0 & viol<5
(4,091 real changes made)

. replace violcat=1 if viol>5
(1,557 real changes made)

. 
. lab def violcat 1 "0" 2 "1-5" 3 ">5"

. lab val violcat violcat

. lab var violcat "Violations"

. 
. * Unweighted version (matches paper)
. preserve

. collapse (mean) hhithreeyearavg ur_rate, by(violcat subcontractor)

. reshape wide hhithreeyearavg ur_rate, i(violcat) j(subcontractor)
(j = 0 1)

Data                               Long   ->   Wide
-----------------------------------------------------------------------------
Number of observations                6   ->   3           
Number of variables                   4   ->   5           
j variable (2 values)     subcontractor   ->   (dropped)
xij variables:
                        hhithreeyearavg   ->   hhithreeyearavg0 hhithreeyearavg
> 1
                                ur_rate   ->   ur_rate0 ur_rate1
-----------------------------------------------------------------------------

. 
. graph hbar (mean) hhithreeyearavg0 hhithreeyearavg1, ///
>   over(violcat, relabel(1 ">5 Violations" 2 "1-5 Violations" 3 "0 Violations"
> )) ///
>   ytitle("Average HHI. Monopsony=1") ///
>   legend(label(1 "Lead Firms") label(2 "Subcontractors"))

. 
. graph export "$figures/fig3_hhibar.pdf", replace
file ./output/figures/fig3_hhibar.pdf saved as PDF format

. restore

. 
. di "Figure 3 saved to: $figures/fig3_hhibar.pdf"
Figure 3 saved to: ./output/figures/fig3_hhibar.pdf

. 
. *----------------------------------------------------------------------------
> ---
. * FIGURE 5: PROBABILITY A FIRM HAS A VIOLATION
. * Source: obes_dos/obes_firm_quits.do lines 183-370
. * Verified: Visual match to paper
. *
. * This figure is a 4-panel combination showing:
. *   - Top-left: Pr(Ever Violate) - Unweighted (company level)
. *   - Top-right: Pr(Ever Violate) - Weighted (company level)
. *   - Bottom-left: Pr(Violation at time t) - Unweighted (panel level)
. *   - Bottom-right: Pr(Violation at time t) - Weighted (panel level)
. *
. * X-axis: HHI (0 to 1)
. * Y-axis: Probability
. * Lines: Lead Firm (solid) vs Subcontractor (dashed)
. *----------------------------------------------------------------------------
> ---
. 
. di "===== FIGURE 5: PROBABILITY A FIRM HAS A VIOLATION ====="
===== FIGURE 5: PROBABILITY A FIRM HAS A VIOLATION =====

. 
. use "$data/master_db.dta", clear

. keep if category_set==3
(113,347 observations deleted)

. 
. set scheme plotplain

. 
. egen company = group(name)
(11 missing values generated)

. 
. * Collapse to firm-year panel
. collapse (rawsum) nbr_h1bs (rawsum) viol (mean) hhithreeyearavg ur_rate subco
> ntractor [fw=fw_h1bs], by(company year)

. 
. gen fw_h1bs=round(nbr_h1bs)

. gen logh1bs=log(nbr_h1bs)

. 
. xtset company year

Panel variable: company (unbalanced)
 Time variable: year, 2001 to 2017, but with gaps
         Delta: 1 unit

. 
. replace viol = round(viol)
(3,231 real changes made)

. replace viol = 1 if viol!=. & viol>0
(2,340 real changes made)

. 
. * Panel restrictions (firms with at least 3 years)
. gen run = .
(965,708 missing values generated)

. bysort company: replace run = cond(L.run == ., 1, L.run +1)
(965,708 real changes made)

. bysort company: egen maxrun = max(run)

. drop if maxrun<3
(560,235 observations deleted)

. tsfill, full

. 
. * Handle spell structure
. tsspell, f(L.maxrun ==.)

. 
. bysort company _spell: egen maxspell = max(run)
(509,985 missing values generated)

. foreach var in nbr_h1bs hhithreeyearavg ur_rate subcontractor fw_h1bs logh1bs
>  {
  2.   replace `var'=. if maxspell!=maxrun
  3. }
(76,572 real changes made, 76,572 to missing)
(76,519 real changes made, 76,519 to missing)
(76,572 real changes made, 76,572 to missing)
(76,572 real changes made, 76,572 to missing)
(76,572 real changes made, 76,572 to missing)
(76,572 real changes made, 76,572 to missing)

. 
. *--- Panel-level: Pr(Violation at time t) ---
. xtset company year

Panel variable: company (strongly balanced)
 Time variable: year, 2001 to 2017
         Delta: 1 unit

. 
. * Unweighted
. qui probit viol L.c.hhithreeyearavg#L.c.hhithreeyearavg#L.c.hhithreeyearavg##
> i.subcontractor L.logh1bs i.year, vce(robust)

. margins, at(L.hhithreeyearavg=(0(.1)1) subcontractor=(0(1)1)) vsquish post

Predictive margins                                     Number of obs = 268,500
Model VCE: Robust

Expression: Pr(viol), predict()
1._at:  L.hhithreeyear~g =  0
        subcontractor    =  0
2._at:  L.hhithreeyear~g =  0
        subcontractor    =  1
3._at:  L.hhithreeyear~g = .1
        subcontractor    =  0
4._at:  L.hhithreeyear~g = .1
        subcontractor    =  1
5._at:  L.hhithreeyear~g = .2
        subcontractor    =  0
6._at:  L.hhithreeyear~g = .2
        subcontractor    =  1
7._at:  L.hhithreeyear~g = .3
        subcontractor    =  0
8._at:  L.hhithreeyear~g = .3
        subcontractor    =  1
9._at:  L.hhithreeyear~g = .4
        subcontractor    =  0
10._at: L.hhithreeyear~g = .4
        subcontractor    =  1
11._at: L.hhithreeyear~g = .5
        subcontractor    =  0
12._at: L.hhithreeyear~g = .5
        subcontractor    =  1
13._at: L.hhithreeyear~g = .6
        subcontractor    =  0
14._at: L.hhithreeyear~g = .6
        subcontractor    =  1
15._at: L.hhithreeyear~g = .7
        subcontractor    =  0
16._at: L.hhithreeyear~g = .7
        subcontractor    =  1
17._at: L.hhithreeyear~g = .8
        subcontractor    =  0
18._at: L.hhithreeyear~g = .8
        subcontractor    =  1
19._at: L.hhithreeyear~g = .9
        subcontractor    =  0
20._at: L.hhithreeyear~g = .9
        subcontractor    =  1
21._at: L.hhithreeyear~g =  1
        subcontractor    =  0
22._at: L.hhithreeyear~g =  1
        subcontractor    =  1

------------------------------------------------------------------------------
             |            Delta-method
             |     Margin   std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
         _at |
          1  |   .0064376   .0001871    34.41   0.000     .0060709    .0068044
          2  |    .018793   .0006945    27.06   0.000     .0174319    .0201542
          3  |   .0064329   .0001864    34.51   0.000     .0060676    .0067983
          4  |    .018732   .0006904    27.13   0.000     .0173789     .020085
          5  |   .0063998   .0001824    35.08   0.000     .0060423    .0067574
          6  |   .0183092   .0006662    27.48   0.000     .0170035    .0196149
          7  |   .0063108   .0001798    35.10   0.000     .0059584    .0066632
          8  |   .0172025   .0006398    26.89   0.000     .0159484    .0184565
          9  |   .0061405   .0002054    29.90   0.000      .005738    .0065431
         10  |   .0152108   .0007101    21.42   0.000     .0138191    .0166026
         11  |   .0058688   .0002954    19.87   0.000     .0052897    .0064478
         12  |   .0123597   .0009308    13.28   0.000     .0105354     .014184
         13  |   .0054831   .0004526    12.11   0.000     .0045959    .0063703
         14  |   .0089695   .0011621     7.72   0.000     .0066918    .0112472
         15  |   .0049826    .000656     7.60   0.000     .0036969    .0062683
         16  |   .0056083   .0012144     4.62   0.000      .003228    .0079886
         17  |   .0043797   .0008765     5.00   0.000     .0026618    .0060977
         18  |   .0028831   .0010032     2.87   0.004     .0009169    .0048494
         19  |   .0037016   .0010792     3.43   0.001     .0015864    .0058169
         20  |   .0011453   .0006202     1.85   0.065    -.0000703    .0023609
         21  |   .0029877   .0012265     2.44   0.015     .0005838    .0053916
         22  |   .0003236   .0002662     1.22   0.224    -.0001982    .0008454
------------------------------------------------------------------------------

. marginsplot, legend(pos(6) col(2) order(4 "Subcontractor" 3 "Lead Firm")) ///
>   plot1opts(lpattern(".")) plot2opts(lpattern("l")) ///
>   xtitle(HHI at t-1) ytitle("Pr(Violation at time t)") title("") ///
>   saving("$figures/viol_pro.gph", replace)

Variables that uniquely identify margins: L.hhithreeyearavg subcontractor
file ./output/figures/viol_pro.gph saved

. 
. * Weighted
. qui probit viol L.c.hhithreeyearavg#L.c.hhithreeyearavg#L.c.hhithreeyearavg##
> i.subcontractor L.logh1bs i.year [fw=L.fw_h1bs], vce(robust)

. margins, at(L.hhithreeyearavg=(0(.1)1) subcontractor=(0(1)1)) vsquish post

Predictive margins                                   Number of obs = 3,074,987
Model VCE: Robust

Expression: Pr(viol), predict()
1._at:  L.hhithreeyear~g =  0
        subcontractor    =  0
2._at:  L.hhithreeyear~g =  0
        subcontractor    =  1
3._at:  L.hhithreeyear~g = .1
        subcontractor    =  0
4._at:  L.hhithreeyear~g = .1
        subcontractor    =  1
5._at:  L.hhithreeyear~g = .2
        subcontractor    =  0
6._at:  L.hhithreeyear~g = .2
        subcontractor    =  1
7._at:  L.hhithreeyear~g = .3
        subcontractor    =  0
8._at:  L.hhithreeyear~g = .3
        subcontractor    =  1
9._at:  L.hhithreeyear~g = .4
        subcontractor    =  0
10._at: L.hhithreeyear~g = .4
        subcontractor    =  1
11._at: L.hhithreeyear~g = .5
        subcontractor    =  0
12._at: L.hhithreeyear~g = .5
        subcontractor    =  1
13._at: L.hhithreeyear~g = .6
        subcontractor    =  0
14._at: L.hhithreeyear~g = .6
        subcontractor    =  1
15._at: L.hhithreeyear~g = .7
        subcontractor    =  0
16._at: L.hhithreeyear~g = .7
        subcontractor    =  1
17._at: L.hhithreeyear~g = .8
        subcontractor    =  0
18._at: L.hhithreeyear~g = .8
        subcontractor    =  1
19._at: L.hhithreeyear~g = .9
        subcontractor    =  0
20._at: L.hhithreeyear~g = .9
        subcontractor    =  1
21._at: L.hhithreeyear~g =  1
        subcontractor    =  0
22._at: L.hhithreeyear~g =  1
        subcontractor    =  1

------------------------------------------------------------------------------
             |            Delta-method
             |     Margin   std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
         _at |
          1  |   .0253332   .0001235   205.07   0.000     .0250911    .0255753
          2  |   .0612827   .0002361   259.54   0.000     .0608199    .0617455
          3  |   .0253046    .000123   205.79   0.000     .0250636    .0255456
          4  |   .0611174   .0002348   260.32   0.000     .0606572    .0615776
          5  |   .0251054   .0001197   209.77   0.000     .0248708      .02534
          6  |   .0599698   .0002269   264.34   0.000     .0595251    .0604144
          7  |   .0245713   .0001171   209.87   0.000     .0243418    .0248008
          8  |   .0569392   .0002179   261.26   0.000     .0565121    .0573664
          9  |   .0235584   .0001352   174.29   0.000     .0232935    .0238233
         10  |   .0513828   .0002427   211.67   0.000      .050907    .0518586
         11  |   .0219648   .0001973   111.35   0.000     .0215782    .0223514
         12  |   .0431675   .0003288   131.29   0.000     .0425231    .0438119
         13  |   .0197566   .0002985    66.19   0.000     .0191716    .0203417
         14  |   .0329068   .0004366    75.38   0.000     .0320511    .0337624
         15  |   .0169907    .000417    40.74   0.000     .0161733    .0178081
         16  |   .0220113   .0004959    44.38   0.000     .0210393    .0229834
         17  |   .0138266   .0005254    26.32   0.000     .0127968    .0148564
         18  |   .0123494   .0004551    27.14   0.000     .0114575    .0132413
         19  |   .0105166   .0005944    17.69   0.000     .0093517    .0116815
         20  |   .0054653   .0003193    17.11   0.000     .0048395    .0060912
         21  |   .0073656   .0006003    12.27   0.000     .0061891    .0085421
         22  |   .0017553   .0001588    11.06   0.000     .0014441    .0020665
------------------------------------------------------------------------------

. marginsplot, legend(pos(6) col(2) order(4 "Subcontractor" 3 "Lead Firm")) ///
>   plot1opts(lpattern(".")) plot2opts(lpattern("l")) ///
>   xtitle(HHI at t-1) ytitle("Pr(Violation at time t)") title("") ///
>   saving("$figures/viol_pro_wt.gph", replace)

Variables that uniquely identify margins: L.hhithreeyearavg subcontractor
file ./output/figures/viol_pro_wt.gph saved

. 
. *--- Company-level: Pr(Ever Violate) ---
. * Collapse to company level
. bysort company: egen everviol = max(viol)

. collapse (max) everviol (rawsum) nbr_h1bs (mean) hhithreeyearavg ur_rate subc
> ontractor [fw=fw_h1bs], by(company)

. 
. rename everviol viol

. lab var viol "Ever Violates"

. gen logh1bs=log(nbr_h1bs)

. replace nbr_h1bs=round(nbr_h1bs)
(4,130 real changes made)

. replace viol=1 if viol>1
(0 real changes made)

. 
. * Unweighted
. qui probit viol c.hhithreeyearavg#c.hhithreeyearavg#c.hhithreeyearavg##i.subc
> ontractor logh1bs, vce(robust)

. margins, at(hhithreeyearavg=(0(.1)1) subcontractor=(0(1)1)) vsquish post

Predictive margins                                      Number of obs = 59,188
Model VCE: Robust

Expression: Pr(viol), predict()
1._at:  hhithreeyearavg =  0
        subcontractor   =  0
2._at:  hhithreeyearavg =  0
        subcontractor   =  1
3._at:  hhithreeyearavg = .1
        subcontractor   =  0
4._at:  hhithreeyearavg = .1
        subcontractor   =  1
5._at:  hhithreeyearavg = .2
        subcontractor   =  0
6._at:  hhithreeyearavg = .2
        subcontractor   =  1
7._at:  hhithreeyearavg = .3
        subcontractor   =  0
8._at:  hhithreeyearavg = .3
        subcontractor   =  1
9._at:  hhithreeyearavg = .4
        subcontractor   =  0
10._at: hhithreeyearavg = .4
        subcontractor   =  1
11._at: hhithreeyearavg = .5
        subcontractor   =  0
12._at: hhithreeyearavg = .5
        subcontractor   =  1
13._at: hhithreeyearavg = .6
        subcontractor   =  0
14._at: hhithreeyearavg = .6
        subcontractor   =  1
15._at: hhithreeyearavg = .7
        subcontractor   =  0
16._at: hhithreeyearavg = .7
        subcontractor   =  1
17._at: hhithreeyearavg = .8
        subcontractor   =  0
18._at: hhithreeyearavg = .8
        subcontractor   =  1
19._at: hhithreeyearavg = .9
        subcontractor   =  0
20._at: hhithreeyearavg = .9
        subcontractor   =  1
21._at: hhithreeyearavg =  1
        subcontractor   =  0
22._at: hhithreeyearavg =  1
        subcontractor   =  1

------------------------------------------------------------------------------
             |            Delta-method
             |     Margin   std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
         _at |
          1  |   .0149955   .0006057    24.76   0.000     .0138083    .0161828
          2  |   .0292273   .0017048    17.14   0.000      .025886    .0325687
          3  |   .0149832   .0006021    24.89   0.000     .0138032    .0161632
          4  |   .0291163   .0016881    17.25   0.000     .0258077    .0324248
          5  |   .0148968   .0005822    25.59   0.000     .0137556    .0160379
          6  |   .0283486   .0015978    17.74   0.000      .025217    .0314801
          7  |   .0146644   .0005833    25.14   0.000     .0135211    .0158077
          8  |   .0263505   .0015815    16.66   0.000     .0232509    .0294502
          9  |   .0142209   .0007694    18.48   0.000     .0127129    .0157288
         10  |   .0228008   .0021161    10.77   0.000     .0186533    .0269483
         11  |   .0135151   .0012684    10.66   0.000     .0110291    .0160012
         12  |   .0178388    .003121     5.72   0.000     .0117218    .0239558
         13  |   .0125189   .0020344     6.15   0.000     .0085316    .0165063
         14  |   .0121726   .0038862     3.13   0.002     .0045558    .0197893
         15  |   .0112359   .0029662     3.79   0.000     .0054223    .0170496
         16  |   .0069102   .0037903     1.82   0.068    -.0005187    .0143391
         17  |   .0097078   .0039296     2.47   0.013     .0020059    .0174096
         18  |   .0030604   .0027563     1.11   0.267    -.0023418    .0084627
         19  |   .0080151   .0047575     1.68   0.092    -.0013094    .0173397
         20  |    .000967   .0013868     0.70   0.486    -.0017511    .0036851
         21  |   .0062705    .005276     1.19   0.235    -.0040703    .0166113
         22  |   .0001923   .0004301     0.45   0.655    -.0006506    .0010352
------------------------------------------------------------------------------

. marginsplot, legend(pos(6) col(2) order(4 "Subcontractor" 3 "Lead Firm")) ///
>   plot1opts(lpattern(".")) plot2opts(lpattern("l")) ///
>   xtitle(HHI) ytitle("Pr(Ever Violate)") title("") ///
>   saving("$figures/viol_pro_co.gph", replace)

Variables that uniquely identify margins: hhithreeyearavg subcontractor
file ./output/figures/viol_pro_co.gph saved

. 
. * Weighted
. qui probit viol c.hhithreeyearavg#c.hhithreeyearavg#c.hhithreeyearavg##i.subc
> ontractor logh1bs [fw=nbr_h1bs], vce(robust)

. margins, at(hhithreeyearavg=(0(.1)1) subcontractor=(0(1)1)) vsquish post

Predictive margins                                   Number of obs = 3,459,214
Model VCE: Robust

Expression: Pr(viol), predict()
1._at:  hhithreeyearavg =  0
        subcontractor   =  0
2._at:  hhithreeyearavg =  0
        subcontractor   =  1
3._at:  hhithreeyearavg = .1
        subcontractor   =  0
4._at:  hhithreeyearavg = .1
        subcontractor   =  1
5._at:  hhithreeyearavg = .2
        subcontractor   =  0
6._at:  hhithreeyearavg = .2
        subcontractor   =  1
7._at:  hhithreeyearavg = .3
        subcontractor   =  0
8._at:  hhithreeyearavg = .3
        subcontractor   =  1
9._at:  hhithreeyearavg = .4
        subcontractor   =  0
10._at: hhithreeyearavg = .4
        subcontractor   =  1
11._at: hhithreeyearavg = .5
        subcontractor   =  0
12._at: hhithreeyearavg = .5
        subcontractor   =  1
13._at: hhithreeyearavg = .6
        subcontractor   =  0
14._at: hhithreeyearavg = .6
        subcontractor   =  1
15._at: hhithreeyearavg = .7
        subcontractor   =  0
16._at: hhithreeyearavg = .7
        subcontractor   =  1
17._at: hhithreeyearavg = .8
        subcontractor   =  0
18._at: hhithreeyearavg = .8
        subcontractor   =  1
19._at: hhithreeyearavg = .9
        subcontractor   =  0
20._at: hhithreeyearavg = .9
        subcontractor   =  1
21._at: hhithreeyearavg =  1
        subcontractor   =  0
22._at: hhithreeyearavg =  1
        subcontractor   =  1

------------------------------------------------------------------------------
             |            Delta-method
             |     Margin   std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
         _at |
          1  |    .082885   .0002206   375.70   0.000     .0824526    .0833174
          2  |   .1945297   .0003489   557.60   0.000     .1938459    .1952135
          3  |    .082691   .0002184   378.56   0.000     .0822628    .0831191
          4  |   .1939675   .0003465   559.73   0.000     .1932883    .1946467
          5  |   .0813424   .0002067   393.57   0.000     .0809374    .0817475
          6  |   .1900599   .0003333   570.20   0.000     .1894066    .1907132
          7  |   .0777655   .0002068   376.06   0.000     .0773602    .0781708
          8  |   .1796985   .0003254   552.17   0.000     .1790606    .1803363
          9  |   .0711433   .0002971   239.46   0.000      .070561    .0717256
         10  |   .1605573   .0003992   402.24   0.000      .159775    .1613396
         11  |   .0611797   .0004916   124.44   0.000     .0602161    .0621433
         12  |   .1320059   .0005916   223.13   0.000     .1308464    .1331654
         13  |   .0483783   .0007156    67.60   0.000     .0469757    .0497809
         14  |   .0962434   .0008056   119.47   0.000     .0946645    .0978224
         15  |   .0341858   .0008709    39.25   0.000     .0324788    .0358928
         16  |   .0589644   .0008887    66.35   0.000     .0572226    .0607063
         17  |   .0207757   .0008677    23.94   0.000     .0190751    .0224763
         18  |   .0280449   .0007336    38.23   0.000      .026607    .0294828
         19  |   .0103095   .0006818    15.12   0.000     .0089733    .0116458
         20  |   .0092267   .0004067    22.69   0.000     .0084296    .0100238
         21  |   .0038941   .0003976     9.79   0.000     .0031148    .0046734
         22  |   .0017812    .000129    13.81   0.000     .0015283    .0020341
------------------------------------------------------------------------------

. marginsplot, legend(pos(6) col(2) order(4 "Subcontractor" 3 "Lead Firm")) ///
>   plot1opts(lpattern(".")) plot2opts(lpattern("l")) ///
>   xtitle(HHI) ytitle("Pr(Ever Violate)") title("") ///
>   saving("$figures/viol_pro_co_wt.gph", replace)

Variables that uniquely identify margins: hhithreeyearavg subcontractor
file ./output/figures/viol_pro_co_wt.gph saved

. 
. *--- Combine into 4-panel figure ---
. 
. graph combine "$figures/viol_pro_co.gph" "$figures/viol_pro_co_wt.gph" "$figu
> res/viol_pro.gph" "$figures/viol_pro_wt.gph"

. graph export "$figures/fig5_probs.pdf", replace
file ./output/figures/fig5_probs.pdf saved as PDF format

. 
. di "Figure 5 saved to: $figures/fig5_probs.pdf"
Figure 5 saved to: ./output/figures/fig5_probs.pdf

. 
. *----------------------------------------------------------------------------
> ---
. * FIGURE 4: AVERAGE VIOLATIONS INTENSITY BY HHI, SUBCONTRACTOR, AND SKILL LEV
> EL
. * Source: 2019_find_pay_rates.do lines 351-354
. * Verified: Visual match to paper
. *
. * This figure shows a horizontal bar chart of mean violations intensity
. * by HHI category (Low, Moderate, High), subcontractor status (Lead vs Sub),
. * and skill level (Low Skill vs High Skill).
. *
. * REQUIRES: low_skill and hhicat variables (created by prepare_replication_da
> ta.do)
. *----------------------------------------------------------------------------
> ---
. 
. di "===== FIGURE 4: VIOLATIONS INTENSITY BY SKILL LEVEL ====="
===== FIGURE 4: VIOLATIONS INTENSITY BY SKILL LEVEL =====

. 
. use "$data/master_db.dta", clear

. 
. * Restrict to observations with skill level data
. drop if low_skill == .
(1,091,189 observations deleted)

. di "Observations with skill level data: " _N
Observations with skill level data: 375175

. 
. * Set scheme
. set scheme plotplainblind

. 
.     * Create proper labels for the figure
.     * low_skill: 0 = High Skill, 1 = Low Skill
.     label define skill_lbl 0 "High Skill" 1 "Low Skill", replace

.     label values low_skill skill_lbl

. 
.     * subcontractor_2019: 0 = Lead Firm, 1 = Subcontractor (from 2019 data)
.     label define sub_lbl 0 "Lead Firm" 1 "Subcontractor", replace

.     label values subcontractor_2019 sub_lbl

. 
.     * hhicat: 1 = Low, 2 = Moderate, 3 = High
.     label define hhi_lbl 1 "Low HHI" 2 "Moderate HHI" 3 "High HHI", replace

.     label values hhicat hhi_lbl

. 
.     * Generate Figure 4: Violations intensity by skill level, subcontractor, 
> HHI
.     * ORDER matches original paper: over(low_skill) over(subcontractor) over(
> hhicat)
.     * - Innermost (bars): skill level (High Skill vs Low Skill)
.     * - Middle: subcontractor status (Lead Firm vs Subcontractor)
.     * - Outermost: HHI category (Low, Moderate, High - descending puts High a
> t top)
.     * NOTE: Uses subcontractor_2019 to match original methodology
.     graph hbar (mean) logviol, ///
>         over(low_skill) over(subcontractor_2019) over(hhicat, descending) ///
>         ytitle("Mean Violations Intensity") ///
>         legend(order(1 "High Skill" 2 "Low Skill") position(3))

. 
. graph export "$figures/fig4_viol_intensity.pdf", replace
file ./output/figures/fig4_viol_intensity.pdf saved as PDF format

. 
. di "Figure 4 saved to: $figures/fig4_viol_intensity.pdf"
Figure 4 saved to: ./output/figures/fig4_viol_intensity.pdf

. di ""


. di "===== FIGURE GENERATION COMPLETE ====="
===== FIGURE GENERATION COMPLETE =====

. di ""


. di "Figures generated/available:"
Figures generated/available:

. di "  - $figures/fig1_network.pdf (Pre-generated - source data 3.1 GB, contac
> t author)"
  - ./output/figures/fig1_network.pdf (Pre-generated - source data 3.1 GB, cont
> act author)

. di "  - $figures/fig2a_kdensity.pdf (Generated - requires diff_adj variable)"
  - ./output/figures/fig2a_kdensity.pdf (Generated - requires diff_adj variable
> )

. di "  - $figures/fig2b_prob_viol.pdf (Generated - requires diff_adj variable)
> "
  - ./output/figures/fig2b_prob_viol.pdf (Generated - requires diff_adj variabl
> e)

. di "  - $figures/fig3_hhibar.pdf (Generated from master_db.dta)"
  - ./output/figures/fig3_hhibar.pdf (Generated from master_db.dta)

. di "  - $figures/fig4_viol_intensity.pdf (Generated - requires low_skill vari
> able)"
  - ./output/figures/fig4_viol_intensity.pdf (Generated - requires low_skill va
> riable)

. di "  - $figures/fig5_probs.pdf (Generated from master_db.dta)"
  - ./output/figures/fig5_probs.pdf (Generated from master_db.dta)

. di ""


. di "Figures NOT included:"
Figures NOT included:

. di "  - Figure 6: Theoretical Model Diagram (manually created, not Stata-gene
> rated)"
  - Figure 6: Theoretical Model Diagram (manually created, not Stata-generated)

. di "              Contact corresponding author for this figure."
              Contact corresponding author for this figure.

. di ""


. di "NOTE: Run prepare_replication_data.do first to create comprehensive maste
> r_db.dta"
NOTE: Run prepare_replication_data.do first to create comprehensive master_db.d
> ta

. di "      with all merged data and derived variables."
      with all merged data and derived variables.

. di ""


. 
. * End of figures file
. 
end of do-file

. 
. *----------------------------------------------------------------------------
> ---
. * SUMMARY
. *----------------------------------------------------------------------------
> ---
. di ""


. di "=========================================================================
> ======"
===============================================================================

. di "REPLICATION COMPLETE"
REPLICATION COMPLETE

. di "=========================================================================
> ======"
===============================================================================

. di ""


. di "Output files saved to:"
Output files saved to:

. di "  Tables: $tables"
  Tables: ./output/tables

. di "  Figures: $figures"
  Figures: ./output/figures

. di ""


. di "Main Tables:"
Main Tables:

. di "  - Table 1: table1.tex (Descriptive Statistics)"
  - Table 1: table1.tex (Descriptive Statistics)

. di "  - Table 2: table2.tex (Wages, Skill Levels)"
  - Table 2: table2.tex (Wages, Skill Levels)

. di "  - Table 3: table3.tex (Log Violations)"
  - Table 3: table3.tex (Log Violations)

. di "  - Table 4: table4.tex (IV Regressions)"
  - Table 4: table4.tex (IV Regressions)

. di "  - Table 5: table5a.tex (Marginal Effects)"
  - Table 5: table5a.tex (Marginal Effects)

. di "  - Table 6: table5b_panelA.tex, table5b_panelB.tex (Probabilities)"
  - Table 6: table5b_panelA.tex, table5b_panelB.tex (Probabilities)

. di ""


. di "Appendix Tables:"
Appendix Tables:

. di "  - Table A.1: table_a1.tex (Negative Binomial)"
  - Table A.1: table_a1.tex (Negative Binomial)

. di "  - Table A.2: table_a2_panelA.tex, table_a2_panelB.tex"
  - Table A.2: table_a2_panelA.tex, table_a2_panelB.tex

. di "  - Table A.3: table_a3_panelA.tex, table_a3_panelB.tex"
  - Table A.3: table_a3_panelA.tex, table_a3_panelB.tex

. di "  - Table A.4: table_a4.tex"
  - Table A.4: table_a4.tex

. di "  - Table A.5: table_a5_panelA.tex, table_a5_panelB.tex"
  - Table A.5: table_a5_panelA.tex, table_a5_panelB.tex

. di "  - Table A.6: table_a6.tex"
  - Table A.6: table_a6.tex

. di "  - Table A.7: table_a7.tex"
  - Table A.7: table_a7.tex

. di "  - Table A.8: table_a8.tex"
  - Table A.8: table_a8.tex

. di "  - Table A.9: table_a9_panelA.tex, table_a9_panelB.tex"
  - Table A.9: table_a9_panelA.tex, table_a9_panelB.tex

. di "  - Table A.10: table_a10.tex"
  - Table A.10: table_a10.tex

. di "  - Table A.11: table_a11_panelA.tex, table_a11_panelB.tex"
  - Table A.11: table_a11_panelA.tex, table_a11_panelB.tex

. di "  - Table A.12: table_a12.tex"
  - Table A.12: table_a12.tex

. di ""


. di "Figures:"
Figures:

. di "  - Figure 1: fig1_network.pdf (pre-generated)"
  - Figure 1: fig1_network.pdf (pre-generated)

. di "  - Figure 2a: fig2a_kdensity.pdf"
  - Figure 2a: fig2a_kdensity.pdf

. di "  - Figure 2b: fig2b_prob_viol.pdf"
  - Figure 2b: fig2b_prob_viol.pdf

. di "  - Figure 3: fig3_hhibar.pdf"
  - Figure 3: fig3_hhibar.pdf

. di "  - Figure 4: fig4_viol_intensity.pdf"
  - Figure 4: fig4_viol_intensity.pdf

. di "  - Figure 5: fig5_probs.pdf"
  - Figure 5: fig5_probs.pdf

. di ""


. di "To compile LaTeX document:"
To compile LaTeX document:

. di "  cd $root"
  cd .

. di "  pdflatex replication_paper.tex"
  pdflatex replication_paper.tex

. di "  pdflatex replication_paper.tex"
  pdflatex replication_paper.tex

. di ""


. di "Finished: $S_DATE $S_TIME"
Finished: 14 Feb 2026 21:35:53

. di "=========================================================================
> ======"
===============================================================================

. 
. log close
      name:  <unnamed>
       log:  /Users/peternorlander/replication/for_upload/replication_log.txt
  log type:  text
 closed on:  14 Feb 2026, 21:35:53
-------------------------------------------------------------------------------
